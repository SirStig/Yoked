2025-01-26 18:46:36,111 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 18:46:36,111 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 18:46:36,111 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 18:46:36,126 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 18:46:36,702 [INFO] [backend.main] Session validation middleware added.
2025-01-26 18:46:36,702 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 18:46:36,702 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 18:46:36,702 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 18:46:36,702 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 18:46:36,706 [INFO] [backend.main] Auth router registered.
2025-01-26 18:46:36,711 [INFO] [backend.main] User router registered.
2025-01-26 18:46:36,714 [INFO] [backend.main] Workout router registered.
2025-01-26 18:46:36,723 [INFO] [backend.main] Payment router registered.
2025-01-26 18:46:36,728 [INFO] [backend.main] Subscription router registered.
2025-01-26 18:46:36,729 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 18:46:36,731 [INFO] [backend.main] Admin router registered.
2025-01-26 18:48:35,114 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 18:48:35,114 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 18:48:35,114 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 18:48:35,123 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 18:48:35,509 [INFO] [backend.main] Session validation middleware added.
2025-01-26 18:48:35,509 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 18:48:35,511 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 18:48:35,511 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 18:48:35,511 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 18:48:35,513 [INFO] [backend.main] Auth router registered.
2025-01-26 18:48:35,519 [INFO] [backend.main] User router registered.
2025-01-26 18:48:35,519 [INFO] [backend.main] Workout router registered.
2025-01-26 18:48:35,528 [INFO] [backend.main] Payment router registered.
2025-01-26 18:48:35,535 [INFO] [backend.main] Subscription router registered.
2025-01-26 18:48:35,535 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 18:48:35,538 [INFO] [backend.main] Admin router registered.
2025-01-26 18:50:48,152 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 18:50:48,152 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 18:50:48,155 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 18:50:48,162 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 18:50:48,544 [INFO] [backend.main] Session validation middleware added.
2025-01-26 18:50:48,544 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 18:50:48,545 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 18:50:48,545 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 18:50:48,545 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 18:50:48,547 [INFO] [backend.main] Auth router registered.
2025-01-26 18:50:48,553 [INFO] [backend.main] User router registered.
2025-01-26 18:50:48,553 [INFO] [backend.main] Workout router registered.
2025-01-26 18:50:48,562 [INFO] [backend.main] Payment router registered.
2025-01-26 18:50:48,568 [INFO] [backend.main] Subscription router registered.
2025-01-26 18:50:48,568 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 18:50:48,571 [INFO] [backend.main] Admin router registered.
2025-01-26 18:50:55,820 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-26 18:50:55,822 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-26 18:50:55,822 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-26 18:50:58,146 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-26 18:50:58,183 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 18:50:58,186 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 18:54:28,293 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 18:54:28,296 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 18:54:28,296 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 18:54:28,302 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 18:54:28,681 [INFO] [backend.main] Session validation middleware added.
2025-01-26 18:54:28,681 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 18:54:28,681 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 18:54:28,681 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 18:54:28,681 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 18:54:28,686 [INFO] [backend.main] Auth router registered.
2025-01-26 18:54:28,690 [INFO] [backend.main] User router registered.
2025-01-26 18:54:28,693 [INFO] [backend.main] Workout router registered.
2025-01-26 18:54:28,699 [INFO] [backend.main] Payment router registered.
2025-01-26 18:54:28,705 [INFO] [backend.main] Subscription router registered.
2025-01-26 18:54:28,705 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 18:54:28,708 [INFO] [backend.main] Admin router registered.
2025-01-26 18:54:35,903 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-26 18:54:35,903 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-26 18:54:35,903 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-26 18:54:38,146 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-26 18:54:38,173 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 18:54:38,175 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 18:59:46,809 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 18:59:46,809 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 18:59:46,809 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 18:59:46,815 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 18:59:47,212 [INFO] [backend.main] Session validation middleware added.
2025-01-26 18:59:47,214 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 18:59:47,214 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 18:59:47,215 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 18:59:47,215 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 18:59:47,220 [INFO] [backend.main] Auth router registered.
2025-01-26 18:59:47,226 [INFO] [backend.main] User router registered.
2025-01-26 18:59:47,229 [INFO] [backend.main] Workout router registered.
2025-01-26 18:59:47,236 [INFO] [backend.main] Payment router registered.
2025-01-26 18:59:47,242 [INFO] [backend.main] Subscription router registered.
2025-01-26 18:59:47,242 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 18:59:47,245 [INFO] [backend.main] Admin router registered.
2025-01-26 18:59:47,549 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 18:59:47,550 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-26 18:59:47,550 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-26 18:59:47,552 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-26 18:59:48,932 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 18:59:48,934 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-26 18:59:48,934 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-26 18:59:48,935 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-26 18:59:48,941 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 18:59:48,941 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-26 18:59:48,944 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-26 18:59:48,944 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-26 18:59:49,166 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: bec2b12c-2c2f-4f2b-bea5-fb5706d52538)
2025-01-26 18:59:49,174 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 18:59:49,370 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 477d2a17-7272-4318-8376-d3072be61117)
2025-01-26 18:59:49,370 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 18:59:49,565 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: e10b6322-35fd-4571-906f-1371ea70a81e)
2025-01-26 18:59:49,571 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-26 18:59:49,852 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 18:59:49,855 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-26 18:59:49,855 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-26 18:59:49,855 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-26 18:59:49,855 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-26 18:59:49,855 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-26 18:59:50,228 [INFO] [backend.api.auth.auth_service] User created: ID=ce0d57dd-0124-4064-8aad-cc01eddd5653, username=newuser
2025-01-26 18:59:50,231 [INFO] [backend.services.session_service] Creating or fetching session for user_id: ce0d57dd-0124-4064-8aad-cc01eddd5653, is_mobile: False
2025-01-26 18:59:50,236 [DEBUG] [backend.services.session_service] Generated session token: f151226d-5844-4dbe-a45e-1e247b8a5d37
2025-01-26 18:59:50,236 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 01:59:50.236981
2025-01-26 18:59:50,241 [INFO] [backend.services.session_service] New session created for user_id: ce0d57dd-0124-4064-8aad-cc01eddd5653, session_id: 2be8174c-da55-48de-8a26-7380cff849e2
2025-01-26 18:59:50,242 [INFO] [backend.main] Response status: 200
2025-01-26 18:59:50,244 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 200 OK"
2025-01-26 18:59:51,800 [INFO] [backend.api.auth.auth_service] User created: ID=195810c8-8a45-4694-81be-7aab61045526, username=testuser
2025-01-26 18:59:52,770 [INFO] [backend.api.auth.auth_service] User created: ID=968deb54-747f-493a-8097-015d19a0cb00, username=testuser
2025-01-26 18:59:52,960 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-26 18:59:53,172 [INFO] [backend.api.auth.auth_service] User created: ID=87812c10-bf64-45c6-82e0-1b01d2cd8489, username=testuser
2025-01-26 18:59:53,372 [INFO] [backend.api.auth.auth_service] User created: ID=fd62ffd3-dafd-4943-869a-69fc28598614, username=testuser
2025-01-26 18:59:53,374 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-26 18:59:53,574 [INFO] [backend.api.auth.auth_service] User created: ID=a64ff71c-0fd2-41b0-adbf-80bbcec63ee0, username=testuser
2025-01-26 18:59:53,768 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-26 18:59:53,771 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-26 18:59:53,796 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 18:59:53,800 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 18:59:54,112 [INFO] [backend.services.mfa] Resetting MFA for user_id: non-existent-user-id
2025-01-26 18:59:54,112 [ERROR] [backend.services.mfa] Database error while resetting MFA for user_id: non-existent-user-id, error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type uuid: "non-existent-user-id"
LINE 3: WHERE users.id = 'non-existent-user-id'::UUID 
                         ^

[SQL: SELECT users.id AS users_id, users.full_name AS users_full_name, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.bio AS users_bio, users.profile_picture AS users_profile_picture, users.fitness_goals AS users_fitness_goals, users.subscription_plan AS users_subscription_plan, users.setup_step AS users_setup_step, users.joined_at AS users_joined_at, users.user_type AS users_user_type, users.admin_secret_key AS users_admin_secret_key, users.flagged_for_review AS users_flagged_for_review, users.age AS users_age, users.gender AS users_gender, users.activity_level AS users_activity_level, users.height AS users_height, users.weight AS users_weight, users.height_unit AS users_height_unit, users.weight_unit AS users_weight_unit, users.profile_version AS users_profile_version, users.accepted_terms AS users_accepted_terms, users.accepted_privacy_policy AS users_accepted_privacy_policy, users.accepted_terms_at AS users_accepted_terms_at, users.accepted_privacy_policy_at AS users_accepted_privacy_policy_at, users.mfa_enabled AS users_mfa_enabled, users.mfa_secret AS users_mfa_secret, users.mfa_backup_codes AS users_mfa_backup_codes, users.email_notifications AS users_email_notifications, users.push_notifications AS users_push_notifications 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s]
[parameters: {'id_1': 'non-existent-user-id', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-01-26 19:00:00,068 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:00:00,070 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:00:00,070 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:00:00,070 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 19:00:00,070 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:00:00,071 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-26 19:00:00,078 [INFO] [backend.main] Response status: 422
2025-01-26 19:00:00,079 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 19:00:01,287 [INFO] [backend.api.auth.auth_service] User created: ID=cd6c92dd-5810-41c5-bb24-2673b5f59b20, username=testuser
2025-01-26 19:00:01,483 [INFO] [backend.api.auth.auth_service] User created: ID=cf4bbc7f-70e0-41bf-8f13-5b391c3243c6, username=testuser
2025-01-26 19:00:01,681 [INFO] [backend.api.auth.auth_service] User created: ID=57301c51-49a8-4291-bc13-0557b7b882c1, username=testuser
2025-01-26 19:00:01,872 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-26 19:48:06,893 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 19:48:06,893 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 19:48:06,893 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 19:48:06,905 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 19:48:07,413 [INFO] [backend.main] Session validation middleware added.
2025-01-26 19:48:07,413 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 19:48:07,413 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 19:48:07,413 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 19:48:07,413 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 19:48:07,416 [INFO] [backend.main] Auth router registered.
2025-01-26 19:48:07,422 [INFO] [backend.main] User router registered.
2025-01-26 19:48:07,425 [INFO] [backend.main] Workout router registered.
2025-01-26 19:48:07,431 [INFO] [backend.main] Payment router registered.
2025-01-26 19:48:07,434 [INFO] [backend.main] Subscription router registered.
2025-01-26 19:48:07,437 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 19:48:07,440 [INFO] [backend.main] Admin router registered.
2025-01-26 19:48:07,733 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:48:07,740 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-26 19:48:07,740 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-26 19:48:07,741 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-26 19:48:09,104 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:48:09,105 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-26 19:48:09,105 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-26 19:48:09,106 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-26 19:48:09,111 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 19:48:09,111 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-26 19:48:09,111 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-26 19:48:09,114 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-26 19:48:09,330 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: bff9162a-b296-409d-a167-ec7a769a7515)
2025-01-26 19:48:09,336 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 19:48:09,534 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 3ee29058-f435-4ef1-b896-7aa1f1654e0a)
2025-01-26 19:48:09,534 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 19:48:09,727 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: ae791459-24f6-43b1-b82b-519982839fbd)
2025-01-26 19:48:09,730 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-26 19:48:10,119 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:48:10,122 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-26 19:48:10,122 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-26 19:48:10,122 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-26 19:48:10,122 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-26 19:48:10,122 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-26 19:48:10,180 [ERROR] [backend.api.auth.auth_routes] Registration failed: Username already registered
2025-01-26 19:48:10,180 [INFO] [backend.main] Response status: 400
2025-01-26 19:48:10,183 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
2025-01-26 19:48:11,682 [INFO] [backend.api.auth.auth_service] User created: ID=c1f9087e-121f-4709-9272-afbbeaebbc00, username=testuser
2025-01-26 19:48:12,664 [INFO] [backend.api.auth.auth_service] User created: ID=8af52cb6-ada5-4511-bb81-8986caa70be6, username=testuser
2025-01-26 19:48:12,858 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-26 19:48:13,077 [INFO] [backend.api.auth.auth_service] User created: ID=60b9de96-fb41-4f55-9788-c04c70204df9, username=testuser
2025-01-26 19:48:13,279 [INFO] [backend.api.auth.auth_service] User created: ID=3267557b-176f-4b39-8aaf-289e45e5bf4c, username=testuser
2025-01-26 19:48:13,279 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-26 19:48:13,479 [INFO] [backend.api.auth.auth_service] User created: ID=f9dbca92-5e6a-407d-a58a-8261ea0c6776, username=testuser
2025-01-26 19:48:13,673 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-26 19:48:13,673 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-26 19:48:13,710 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 19:48:13,712 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 19:48:14,005 [INFO] [backend.services.mfa] Resetting MFA for user_id: non-existent-user-id
2025-01-26 19:48:14,007 [ERROR] [backend.services.mfa] Database error while resetting MFA for user_id: non-existent-user-id, error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type uuid: "non-existent-user-id"
LINE 3: WHERE users.id = 'non-existent-user-id'::UUID 
                         ^

[SQL: SELECT users.id AS users_id, users.full_name AS users_full_name, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.bio AS users_bio, users.profile_picture AS users_profile_picture, users.fitness_goals AS users_fitness_goals, users.subscription_plan AS users_subscription_plan, users.setup_step AS users_setup_step, users.joined_at AS users_joined_at, users.user_type AS users_user_type, users.admin_secret_key AS users_admin_secret_key, users.flagged_for_review AS users_flagged_for_review, users.age AS users_age, users.gender AS users_gender, users.activity_level AS users_activity_level, users.height AS users_height, users.weight AS users_weight, users.height_unit AS users_height_unit, users.weight_unit AS users_weight_unit, users.profile_version AS users_profile_version, users.accepted_terms AS users_accepted_terms, users.accepted_privacy_policy AS users_accepted_privacy_policy, users.accepted_terms_at AS users_accepted_terms_at, users.accepted_privacy_policy_at AS users_accepted_privacy_policy_at, users.mfa_enabled AS users_mfa_enabled, users.mfa_secret AS users_mfa_secret, users.mfa_backup_codes AS users_mfa_backup_codes, users.email_notifications AS users_email_notifications, users.push_notifications AS users_push_notifications 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s]
[parameters: {'id_1': 'non-existent-user-id', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-01-26 19:48:19,802 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:48:19,805 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:48:19,805 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:48:19,805 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 19:48:19,805 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:48:19,805 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-26 19:48:19,811 [INFO] [backend.main] Response status: 422
2025-01-26 19:48:19,814 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 19:48:20,964 [INFO] [backend.api.auth.auth_service] User created: ID=eee2d96a-bdaa-4eba-8e7a-b3c47f3e1a4c, username=testuser
2025-01-26 19:48:21,163 [INFO] [backend.api.auth.auth_service] User created: ID=b6aec963-476c-411f-b97d-f623dfa48669, username=testuser
2025-01-26 19:48:21,358 [INFO] [backend.api.auth.auth_service] User created: ID=40487771-1412-41fd-a396-67046cdae91d, username=testuser
2025-01-26 19:48:21,548 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-26 19:51:38,550 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-26 19:51:38,550 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-26 19:51:38,550 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-26 19:51:38,559 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 19:51:38,925 [INFO] [backend.main] Session validation middleware added.
2025-01-26 19:51:38,925 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 19:51:38,928 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 19:51:38,928 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 19:51:38,928 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 19:51:38,931 [INFO] [backend.main] Auth router registered.
2025-01-26 19:51:38,934 [INFO] [backend.main] User router registered.
2025-01-26 19:51:38,937 [INFO] [backend.main] Workout router registered.
2025-01-26 19:51:38,946 [INFO] [backend.main] Payment router registered.
2025-01-26 19:51:38,949 [INFO] [backend.main] Subscription router registered.
2025-01-26 19:51:38,949 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 19:51:38,952 [INFO] [backend.main] Admin router registered.
2025-01-26 19:51:39,247 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:39,248 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-26 19:51:39,248 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-26 19:51:39,248 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-26 19:51:40,713 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:40,716 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-26 19:51:40,716 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-26 19:51:40,716 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-26 19:51:40,722 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 19:51:40,722 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-26 19:51:40,722 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-26 19:51:40,722 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-26 19:51:40,944 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 22722be1-c8b0-400c-9cdd-c7791012cb3b)
2025-01-26 19:51:40,950 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 19:51:41,145 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 824f2309-24af-4f0c-80cc-30fa68e2c763)
2025-01-26 19:51:41,145 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.REGULAR: 'regular'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-26 19:51:41,338 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: 4f35dd3f-14b6-4786-95a6-f59066671f81)
2025-01-26 19:51:41,341 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-26 19:51:41,601 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:41,604 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-26 19:51:41,604 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-26 19:51:41,604 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-26 19:51:41,604 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-26 19:51:41,604 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-26 19:51:41,666 [ERROR] [backend.api.auth.auth_routes] Registration failed: Username already registered
2025-01-26 19:51:41,669 [INFO] [backend.main] Response status: 400
2025-01-26 19:51:41,669 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
2025-01-26 19:51:43,129 [INFO] [backend.api.auth.auth_service] User created: ID=b5360a09-05dc-4453-b9f4-23f1030c0beb, username=testuser
2025-01-26 19:51:44,095 [INFO] [backend.api.auth.auth_service] User created: ID=8c713233-a83e-4665-b3b7-b0447d058ece, username=testuser
2025-01-26 19:51:44,284 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-26 19:51:44,490 [INFO] [backend.api.auth.auth_service] User created: ID=9e058ec6-bc2c-41a9-92c7-1eb499505c68, username=testuser
2025-01-26 19:51:44,689 [INFO] [backend.api.auth.auth_service] User created: ID=227ae282-419d-45c4-bcda-ba2717230a1f, username=testuser
2025-01-26 19:51:44,691 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-26 19:51:44,889 [INFO] [backend.api.auth.auth_service] User created: ID=f032ab7c-ad37-47f1-b9e9-d2a0a9161be8, username=testuser
2025-01-26 19:51:45,087 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-26 19:51:45,090 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-26 19:51:45,120 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 19:51:45,123 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-26 19:51:45,416 [INFO] [backend.services.mfa] Resetting MFA for user_id: non-existent-user-id
2025-01-26 19:51:45,419 [ERROR] [backend.services.mfa] Database error while resetting MFA for user_id: non-existent-user-id, error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type uuid: "non-existent-user-id"
LINE 3: WHERE users.id = 'non-existent-user-id'::UUID 
                         ^

[SQL: SELECT users.id AS users_id, users.full_name AS users_full_name, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.bio AS users_bio, users.profile_picture AS users_profile_picture, users.fitness_goals AS users_fitness_goals, users.subscription_plan AS users_subscription_plan, users.setup_step AS users_setup_step, users.joined_at AS users_joined_at, users.user_type AS users_user_type, users.admin_secret_key AS users_admin_secret_key, users.flagged_for_review AS users_flagged_for_review, users.age AS users_age, users.gender AS users_gender, users.activity_level AS users_activity_level, users.height AS users_height, users.weight AS users_weight, users.height_unit AS users_height_unit, users.weight_unit AS users_weight_unit, users.profile_version AS users_profile_version, users.accepted_terms AS users_accepted_terms, users.accepted_privacy_policy AS users_accepted_privacy_policy, users.accepted_terms_at AS users_accepted_terms_at, users.accepted_privacy_policy_at AS users_accepted_privacy_policy_at, users.mfa_enabled AS users_mfa_enabled, users.mfa_secret AS users_mfa_secret, users.mfa_backup_codes AS users_mfa_backup_codes, users.email_notifications AS users_email_notifications, users.push_notifications AS users_push_notifications 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s]
[parameters: {'id_1': 'non-existent-user-id', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-01-26 19:51:48,780 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:48,783 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:51:48,783 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:51:48,783 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 19:51:48,783 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:51:48,784 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/
2025-01-26 19:51:48,784 [INFO] [backend.api.subscriptions.subscription_routes] Listing subscription tiers.
2025-01-26 19:51:48,790 [DEBUG] [backend.api.subscriptions.subscription_service] Fetched subscription tiers: [<backend.models.subscription_tier.SubscriptionTier object at 0x00000205C2E43320>, <backend.models.subscription_tier.SubscriptionTier object at 0x00000205C2E432C0>, <backend.models.subscription_tier.SubscriptionTier object at 0x00000205C2E43290>]
2025-01-26 19:51:48,792 [INFO] [backend.main] Response status: 200
2025-01-26 19:51:48,793 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/ "HTTP/1.1 200 OK"
2025-01-26 19:51:48,804 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:48,805 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41
2025-01-26 19:51:48,805 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41
2025-01-26 19:51:48,805 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41
2025-01-26 19:51:48,805 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41
2025-01-26 19:51:48,805 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41
2025-01-26 19:51:48,807 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: 9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41
2025-01-26 19:51:48,807 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier 9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41: 404: Subscription tier not found.
2025-01-26 19:51:48,811 [INFO] [backend.main] Response status: 500
2025-01-26 19:51:48,811 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/9d5d8da9-2ca9-4fe6-85ad-f4a364f58e41 "HTTP/1.1 500 Internal Server Error"
2025-01-26 19:51:48,817 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:48,820 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:51:48,820 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:51:48,820 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 19:51:48,820 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 19:51:48,820 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-26 19:51:48,826 [INFO] [backend.main] Response status: 422
2025-01-26 19:51:48,828 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 19:51:48,836 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:48,836 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/1b69aaf0-182a-461d-9346-5f4aacf647c9
2025-01-26 19:51:48,836 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/1b69aaf0-182a-461d-9346-5f4aacf647c9
2025-01-26 19:51:48,838 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/1b69aaf0-182a-461d-9346-5f4aacf647c9
2025-01-26 19:51:48,838 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/1b69aaf0-182a-461d-9346-5f4aacf647c9
2025-01-26 19:51:48,838 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/1b69aaf0-182a-461d-9346-5f4aacf647c9
2025-01-26 19:51:48,841 [INFO] [backend.main] Response status: 422
2025-01-26 19:51:48,841 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/1b69aaf0-182a-461d-9346-5f4aacf647c9 "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 19:51:48,850 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:48,850 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/70289f31-dbd8-4ad8-86e3-a5982873c2af
2025-01-26 19:51:48,850 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/70289f31-dbd8-4ad8-86e3-a5982873c2af
2025-01-26 19:51:48,850 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/70289f31-dbd8-4ad8-86e3-a5982873c2af
2025-01-26 19:51:48,850 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/70289f31-dbd8-4ad8-86e3-a5982873c2af
2025-01-26 19:51:48,850 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/70289f31-dbd8-4ad8-86e3-a5982873c2af
2025-01-26 19:51:48,853 [INFO] [backend.main] Response status: 422
2025-01-26 19:51:48,853 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/70289f31-dbd8-4ad8-86e3-a5982873c2af "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 19:51:48,862 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 19:51:48,863 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/3df7fef4-c3b3-42a1-af21-6a543d41c6fa/deactivate
2025-01-26 19:51:48,863 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/3df7fef4-c3b3-42a1-af21-6a543d41c6fa/deactivate
2025-01-26 19:51:48,863 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/3df7fef4-c3b3-42a1-af21-6a543d41c6fa/deactivate
2025-01-26 19:51:48,863 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/3df7fef4-c3b3-42a1-af21-6a543d41c6fa/deactivate
2025-01-26 19:51:48,863 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/3df7fef4-c3b3-42a1-af21-6a543d41c6fa/deactivate
2025-01-26 19:51:48,865 [INFO] [backend.main] Response status: 422
2025-01-26 19:51:48,865 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/3df7fef4-c3b3-42a1-af21-6a543d41c6fa/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 19:51:49,238 [INFO] [backend.api.auth.auth_service] User created: ID=7fe8abac-2587-4078-b11d-af54fc606e41, username=testuser
2025-01-26 19:51:49,436 [INFO] [backend.api.auth.auth_service] User created: ID=642d76a0-4852-4b1c-b78e-1454fd122667, username=testuser
2025-01-26 19:51:49,634 [INFO] [backend.api.auth.auth_service] User created: ID=7781d1e0-3e67-4036-8e72-8b63b8970eb1, username=testuser
2025-01-26 19:51:49,823 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-26 20:07:09,738 [INFO] [backend.services.session_service] Creating or fetching session for user_id: bcb19cac-5247-4b19-aef1-940281661da6, is_mobile: False
2025-01-26 20:07:09,740 [DEBUG] [backend.services.session_service] Generated session token: 373f6ec4-6157-40a3-8881-f176c83779a1
2025-01-26 20:07:09,740 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:07:09.740955
2025-01-26 20:07:09,750 [INFO] [backend.services.session_service] New session created for user_id: bcb19cac-5247-4b19-aef1-940281661da6, session_id: c76f6f52-b336-4516-9e87-96d534f820a2
2025-01-26 20:07:09,760 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 10518c4c-cd80-49b9-9496-fdf75ca11ffa, is_mobile: False
2025-01-26 20:07:09,761 [DEBUG] [backend.services.session_service] Generated session token: 183824f6-3ed6-4369-8ddc-9a1b8919c9cb
2025-01-26 20:07:09,761 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:07:09.761390
2025-01-26 20:07:09,762 [INFO] [backend.services.session_service] New session created for user_id: 10518c4c-cd80-49b9-9496-fdf75ca11ffa, session_id: 845f0d55-b33e-4335-b5d6-df448a8edfec
2025-01-26 20:07:09,762 [DEBUG] [backend.services.session_service] Validating session token: 183824f6-3ed6-4369-8ddc-9a1b8919c9cb
2025-01-26 20:07:09,770 [INFO] [backend.services.session_service] Session validated: 845f0d55-b33e-4335-b5d6-df448a8edfec, user_id: 10518c4c-cd80-49b9-9496-fdf75ca11ffa
2025-01-26 20:07:09,774 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 241bdbdd-00c9-44e4-9522-7d6369ce2f06, is_mobile: False
2025-01-26 20:07:09,775 [DEBUG] [backend.services.session_service] Generated session token: 4396928d-9390-4104-b78b-b487f1bc2f3c
2025-01-26 20:07:09,776 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:07:09.776733
2025-01-26 20:07:09,777 [INFO] [backend.services.session_service] New session created for user_id: 241bdbdd-00c9-44e4-9522-7d6369ce2f06, session_id: 389a773e-bf09-41e0-8425-0a67daef5090
2025-01-26 20:07:09,777 [INFO] [backend.services.session_service] Invalidating specific session token: 4396928d-9390-4104-b78b-b487f1bc2f3c
2025-01-26 20:07:09,779 [INFO] [backend.services.session_service] Session invalidated: 4396928d-9390-4104-b78b-b487f1bc2f3c
2025-01-26 20:07:09,782 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 7248fd28-e257-469c-92b6-2fef3a2e829b, is_mobile: False
2025-01-26 20:07:09,783 [DEBUG] [backend.services.session_service] Generated session token: 4f356b57-d023-481a-92a6-33b730c08001
2025-01-26 20:07:09,783 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:07:09.783683
2025-01-26 20:07:09,784 [INFO] [backend.services.session_service] New session created for user_id: 7248fd28-e257-469c-92b6-2fef3a2e829b, session_id: e5131014-1f27-47f1-8f59-454b4b7b40ee
2025-01-26 20:07:09,786 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 7248fd28-e257-469c-92b6-2fef3a2e829b, is_mobile: True
2025-01-26 20:07:09,786 [DEBUG] [backend.services.session_service] Generated session token: 4d7ad8f4-b55e-406c-87be-5808efe29a3e
2025-01-26 20:07:09,786 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:07:09.786567
2025-01-26 20:07:09,788 [INFO] [backend.services.session_service] New session created for user_id: 7248fd28-e257-469c-92b6-2fef3a2e829b, session_id: fc944f03-b74a-41cc-87c8-fe2033e86b13
2025-01-26 20:07:09,788 [INFO] [backend.services.session_service] Invalidating sessions for user_id: 7248fd28-e257-469c-92b6-2fef3a2e829b, is_mobile: None
2025-01-26 20:07:09,789 [INFO] [backend.services.session_service] Invalidated 2 session(s) for user_id: 7248fd28-e257-469c-92b6-2fef3a2e829b
2025-01-26 20:07:09,795 [INFO] [backend.services.session_service] Creating or fetching session for user_id: d1a0fdc4-537c-42da-a288-1f8dd8647b33, is_mobile: False
2025-01-26 20:07:09,796 [DEBUG] [backend.services.session_service] Generated session token: c1ee331c-5ebc-4719-90c5-2aef1a8f1d72
2025-01-26 20:07:09,796 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:07:09.796686
2025-01-26 20:07:09,797 [INFO] [backend.services.session_service] New session created for user_id: d1a0fdc4-537c-42da-a288-1f8dd8647b33, session_id: 2bd19bc7-f050-4061-ab92-9eb6cb1edc9e
2025-01-26 20:07:09,798 [INFO] [backend.services.session_service] Creating or fetching session for user_id: d1a0fdc4-537c-42da-a288-1f8dd8647b33, is_mobile: True
2025-01-26 20:07:09,799 [DEBUG] [backend.services.session_service] Generated session token: 6e22b000-fa3a-47ee-8d19-999b3605c2f0
2025-01-26 20:07:09,799 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:07:09.799926
2025-01-26 20:07:09,800 [INFO] [backend.services.session_service] New session created for user_id: d1a0fdc4-537c-42da-a288-1f8dd8647b33, session_id: fc04d013-d094-45cf-b04a-77dad1fdf021
2025-01-26 20:07:09,800 [DEBUG] [backend.services.session_service] Fetching active sessions for user_id: d1a0fdc4-537c-42da-a288-1f8dd8647b33, is_mobile: None
2025-01-26 20:07:10,032 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 2aae8cdc-a496-4bc1-94d1-c443f6870ca7, is_mobile: False
2025-01-26 20:07:10,033 [DEBUG] [backend.services.session_service] Generated session token: d4741230-56b7-4e9e-9802-1ac88ccbc298
2025-01-26 20:07:10,033 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:07:10.033195
2025-01-26 20:07:10,034 [INFO] [backend.services.session_service] New session created for user_id: 2aae8cdc-a496-4bc1-94d1-c443f6870ca7, session_id: c33e6188-5c65-4673-8490-adc9fde4b8a2
2025-01-26 20:07:10,035 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 2aae8cdc-a496-4bc1-94d1-c443f6870ca7, is_mobile: True
2025-01-26 20:07:10,035 [DEBUG] [backend.services.session_service] Generated session token: ad8155a8-54e9-4754-b5a6-6cd186f3c276
2025-01-26 20:07:10,036 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:07:10.036192
2025-01-26 20:07:10,037 [INFO] [backend.services.session_service] New session created for user_id: 2aae8cdc-a496-4bc1-94d1-c443f6870ca7, session_id: e03ab1d6-c6b6-4cc3-adff-94d1fb0d5b17
2025-01-26 20:07:10,037 [INFO] [backend.services.session_service] Fetching active sessions for user_id: 2aae8cdc-a496-4bc1-94d1-c443f6870ca7
2025-01-26 20:07:10,038 [INFO] [backend.services.session_service] Fetched 2 session(s) for user_id: 2aae8cdc-a496-4bc1-94d1-c443f6870ca7
2025-01-26 20:09:06,467 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 9860a1e6-f10e-4bc9-a2e7-fb0222227b63, is_mobile: False
2025-01-26 20:09:06,469 [DEBUG] [backend.services.session_service] Generated session token: 0ff14086-279d-41d8-bd4b-6d866e53f843
2025-01-26 20:09:06,469 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:09:06.469980
2025-01-26 20:09:06,473 [INFO] [backend.services.session_service] New session created for user_id: 9860a1e6-f10e-4bc9-a2e7-fb0222227b63, session_id: 3c5db8c8-ea71-4ca2-b81a-2b38bdcc4517
2025-01-26 20:09:06,473 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 9860a1e6-f10e-4bc9-a2e7-fb0222227b63, is_mobile: True
2025-01-26 20:09:06,476 [DEBUG] [backend.services.session_service] Generated session token: 825c3ac8-695f-43e6-9d4a-68b52208ed95
2025-01-26 20:09:06,476 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:09:06.476295
2025-01-26 20:09:06,476 [INFO] [backend.services.session_service] New session created for user_id: 9860a1e6-f10e-4bc9-a2e7-fb0222227b63, session_id: a7361ab5-7a34-426e-bef9-25aa8a9cb080
2025-01-26 20:09:06,476 [DEBUG] [backend.services.session_service] Fetching active sessions for user_id: 9860a1e6-f10e-4bc9-a2e7-fb0222227b63, is_mobile: None
2025-01-26 20:09:06,699 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 10027c95-2b69-42c5-8bfe-c19752e8a869, is_mobile: False
2025-01-26 20:09:06,699 [DEBUG] [backend.services.session_service] Generated session token: ff216235-2b2f-4ca7-bcac-8a90702214dd
2025-01-26 20:09:06,699 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:09:06.699058
2025-01-26 20:09:06,699 [INFO] [backend.services.session_service] New session created for user_id: 10027c95-2b69-42c5-8bfe-c19752e8a869, session_id: a87d7083-99b2-4e9d-8d4e-ef69fe104b31
2025-01-26 20:09:06,699 [DEBUG] [backend.services.session_service] Validating session token: ff216235-2b2f-4ca7-bcac-8a90702214dd
2025-01-26 20:09:06,702 [INFO] [backend.services.session_service] Session validated: a87d7083-99b2-4e9d-8d4e-ef69fe104b31, user_id: 10027c95-2b69-42c5-8bfe-c19752e8a869
2025-01-26 20:09:06,709 [INFO] [backend.services.session_service] Creating or fetching session for user_id: b17e187e-4a01-4e72-88c1-eeac17c47e3b, is_mobile: False
2025-01-26 20:09:06,710 [DEBUG] [backend.services.session_service] Generated session token: 9659150a-ef1d-4117-a68e-1b2a19e4ae74
2025-01-26 20:09:06,710 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:09:06.710490
2025-01-26 20:09:06,710 [INFO] [backend.services.session_service] New session created for user_id: b17e187e-4a01-4e72-88c1-eeac17c47e3b, session_id: 318e6fef-71fb-44c4-84a1-fba8ed33699e
2025-01-26 20:09:06,710 [INFO] [backend.services.session_service] Invalidating specific session token: 9659150a-ef1d-4117-a68e-1b2a19e4ae74
2025-01-26 20:09:06,712 [INFO] [backend.services.session_service] Session invalidated: 9659150a-ef1d-4117-a68e-1b2a19e4ae74
2025-01-26 20:09:06,715 [INFO] [backend.services.session_service] Creating or fetching session for user_id: bfdf229b-af4b-49f0-b521-43bb42a20dee, is_mobile: False
2025-01-26 20:09:06,716 [DEBUG] [backend.services.session_service] Generated session token: d0a7069b-33cc-42d6-b6e1-782b0d954e61
2025-01-26 20:09:06,716 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:09:06.716852
2025-01-26 20:09:06,718 [INFO] [backend.services.session_service] New session created for user_id: bfdf229b-af4b-49f0-b521-43bb42a20dee, session_id: 75691e20-c2eb-4bce-9d45-cd8869d42c29
2025-01-26 20:09:06,718 [INFO] [backend.services.session_service] Creating or fetching session for user_id: bfdf229b-af4b-49f0-b521-43bb42a20dee, is_mobile: True
2025-01-26 20:09:06,718 [DEBUG] [backend.services.session_service] Generated session token: 03fdf6af-d977-4fb3-b4ca-e4aa8ec772e8
2025-01-26 20:09:06,718 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:09:06.718602
2025-01-26 20:09:06,718 [INFO] [backend.services.session_service] New session created for user_id: bfdf229b-af4b-49f0-b521-43bb42a20dee, session_id: 06832b68-6ad0-4dc2-89de-c77b4270f214
2025-01-26 20:09:06,721 [INFO] [backend.services.session_service] Invalidating sessions for user_id: bfdf229b-af4b-49f0-b521-43bb42a20dee, is_mobile: None
2025-01-26 20:09:06,722 [INFO] [backend.services.session_service] Invalidated 2 session(s) for user_id: bfdf229b-af4b-49f0-b521-43bb42a20dee
2025-01-26 20:09:06,726 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 19bec444-bffc-4c6f-9437-347cf995c50e, is_mobile: False
2025-01-26 20:09:06,726 [DEBUG] [backend.services.session_service] Generated session token: 1828f5ba-4f27-46fb-9fdc-67c6656398ff
2025-01-26 20:09:06,728 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:09:06.726542
2025-01-26 20:09:06,728 [INFO] [backend.services.session_service] New session created for user_id: 19bec444-bffc-4c6f-9437-347cf995c50e, session_id: cb2a58c2-5b48-4a72-95d4-1cc7b398af5e
2025-01-26 20:09:06,728 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 19bec444-bffc-4c6f-9437-347cf995c50e, is_mobile: True
2025-01-26 20:09:06,728 [DEBUG] [backend.services.session_service] Generated session token: 3d1acd2d-6fb1-4c89-9d26-c7d6bee8da25
2025-01-26 20:09:06,728 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:09:06.728289
2025-01-26 20:09:06,728 [INFO] [backend.services.session_service] New session created for user_id: 19bec444-bffc-4c6f-9437-347cf995c50e, session_id: e08ca059-7e64-4664-a4fa-72c436602c0b
2025-01-26 20:09:06,731 [INFO] [backend.services.session_service] Fetching active sessions for user_id: 19bec444-bffc-4c6f-9437-347cf995c50e
2025-01-26 20:09:06,731 [INFO] [backend.services.session_service] Fetched 2 session(s) for user_id: 19bec444-bffc-4c6f-9437-347cf995c50e
2025-01-26 20:11:05,821 [INFO] [backend.services.session_service] Creating or fetching session for user_id: bd607c34-7042-4a93-9759-7d05a607924c, is_mobile: False
2025-01-26 20:11:05,824 [DEBUG] [backend.services.session_service] Generated session token: 5bb0f3c4-1189-48be-8ce9-9f35d3d05d3f
2025-01-26 20:11:05,824 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:11:05.824519
2025-01-26 20:11:05,827 [INFO] [backend.services.session_service] New session created for user_id: bd607c34-7042-4a93-9759-7d05a607924c, session_id: c96a3370-0292-441a-be1b-4b46962ddc4f
2025-01-26 20:11:05,827 [INFO] [backend.services.session_service] Creating or fetching session for user_id: bd607c34-7042-4a93-9759-7d05a607924c, is_mobile: True
2025-01-26 20:11:05,830 [DEBUG] [backend.services.session_service] Generated session token: 0249f725-fdce-4a41-a7c4-7ba002cc40c5
2025-01-26 20:11:05,830 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:11:05.830833
2025-01-26 20:11:05,830 [INFO] [backend.services.session_service] New session created for user_id: bd607c34-7042-4a93-9759-7d05a607924c, session_id: 3414f777-c6cc-4966-bbea-b91c876a8460
2025-01-26 20:11:05,833 [DEBUG] [backend.services.session_service] Fetching active sessions for user_id: bd607c34-7042-4a93-9759-7d05a607924c, is_mobile: None
2025-01-26 20:11:06,063 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 13eea247-b0a6-4030-86fd-f4d93a5fac05, is_mobile: False
2025-01-26 20:11:06,063 [DEBUG] [backend.services.session_service] Generated session token: 3d4204b4-40b6-48cb-abee-13d7fc57faa0
2025-01-26 20:11:06,063 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:11:06.063961
2025-01-26 20:11:06,063 [INFO] [backend.services.session_service] New session created for user_id: 13eea247-b0a6-4030-86fd-f4d93a5fac05, session_id: 847ad4fd-fac6-464d-abcc-d059dbe986fa
2025-01-26 20:11:06,063 [DEBUG] [backend.services.session_service] Validating session token: 3d4204b4-40b6-48cb-abee-13d7fc57faa0
2025-01-26 20:11:06,068 [INFO] [backend.services.session_service] Session validated: 847ad4fd-fac6-464d-abcc-d059dbe986fa, user_id: 13eea247-b0a6-4030-86fd-f4d93a5fac05
2025-01-26 20:11:06,073 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 87285afe-be11-41d3-962e-d7e7bed9d12d, is_mobile: False
2025-01-26 20:11:06,073 [DEBUG] [backend.services.session_service] Generated session token: e05fb2c8-dc8c-4393-a959-25f5cecabb5f
2025-01-26 20:11:06,073 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:11:06.073747
2025-01-26 20:11:06,073 [INFO] [backend.services.session_service] New session created for user_id: 87285afe-be11-41d3-962e-d7e7bed9d12d, session_id: 49166971-dace-45ea-8562-56ede9fcdf43
2025-01-26 20:11:06,073 [INFO] [backend.services.session_service] Invalidating specific session token: e05fb2c8-dc8c-4393-a959-25f5cecabb5f
2025-01-26 20:11:06,077 [INFO] [backend.services.session_service] Session invalidated: e05fb2c8-dc8c-4393-a959-25f5cecabb5f
2025-01-26 20:11:06,082 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 6a608cf4-4064-455d-979c-85d8b4a6b739, is_mobile: False
2025-01-26 20:11:06,083 [DEBUG] [backend.services.session_service] Generated session token: 1ac48d58-d01f-45df-9887-e928b1dfb8a5
2025-01-26 20:11:06,083 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:11:06.083533
2025-01-26 20:11:06,085 [INFO] [backend.services.session_service] New session created for user_id: 6a608cf4-4064-455d-979c-85d8b4a6b739, session_id: b3e71272-8d1e-4799-bc9b-68e10105765e
2025-01-26 20:11:06,086 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 6a608cf4-4064-455d-979c-85d8b4a6b739, is_mobile: True
2025-01-26 20:11:06,086 [DEBUG] [backend.services.session_service] Generated session token: 115ba3d1-01f9-4501-9042-d7377b0adfc1
2025-01-26 20:11:06,088 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:11:06.088785
2025-01-26 20:11:06,089 [INFO] [backend.services.session_service] New session created for user_id: 6a608cf4-4064-455d-979c-85d8b4a6b739, session_id: e6b649ef-4a5a-41be-b74f-0fb9b4a2f40c
2025-01-26 20:11:06,090 [INFO] [backend.services.session_service] Invalidating sessions for user_id: 6a608cf4-4064-455d-979c-85d8b4a6b739, is_mobile: None
2025-01-26 20:11:06,090 [INFO] [backend.services.session_service] Invalidated 2 session(s) for user_id: 6a608cf4-4064-455d-979c-85d8b4a6b739
2025-01-26 20:11:06,095 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 9aa34d44-7005-4a87-8586-c4ad3a626b89, is_mobile: False
2025-01-26 20:11:06,099 [DEBUG] [backend.services.session_service] Generated session token: dc78bd5e-b56f-4ae2-bb37-a9a36b7d3ec9
2025-01-26 20:11:06,099 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 03:11:06.099041
2025-01-26 20:11:06,099 [INFO] [backend.services.session_service] New session created for user_id: 9aa34d44-7005-4a87-8586-c4ad3a626b89, session_id: d00b64e7-0dfa-42a6-961e-f75856149b6d
2025-01-26 20:11:06,099 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 9aa34d44-7005-4a87-8586-c4ad3a626b89, is_mobile: True
2025-01-26 20:11:06,102 [DEBUG] [backend.services.session_service] Generated session token: 87ea829f-c527-40e9-8478-3c1baa0b371c
2025-01-26 20:11:06,102 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 03:11:06.102052
2025-01-26 20:11:06,102 [INFO] [backend.services.session_service] New session created for user_id: 9aa34d44-7005-4a87-8586-c4ad3a626b89, session_id: f27eb01f-a0ba-4867-bf12-6fc334c75ec7
2025-01-26 20:11:06,102 [INFO] [backend.services.session_service] Fetching active sessions for user_id: 9aa34d44-7005-4a87-8586-c4ad3a626b89
2025-01-26 20:11:06,105 [INFO] [backend.services.session_service] Fetched 2 session(s) for user_id: 9aa34d44-7005-4a87-8586-c4ad3a626b89
2025-01-26 20:40:11,787 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 20:40:12,217 [INFO] [backend.main] Session validation middleware added.
2025-01-26 20:40:12,218 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 20:40:12,218 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 20:40:12,218 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 20:40:12,218 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 20:40:12,221 [INFO] [backend.main] Auth router registered.
2025-01-26 20:40:12,226 [INFO] [backend.main] User router registered.
2025-01-26 20:40:12,229 [INFO] [backend.main] Workout router registered.
2025-01-26 20:40:12,236 [INFO] [backend.main] Payment router registered.
2025-01-26 20:40:12,242 [INFO] [backend.main] Subscription router registered.
2025-01-26 20:40:12,242 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 20:40:12,244 [INFO] [backend.main] Admin router registered.
2025-01-26 20:41:21,917 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 20:41:22,367 [INFO] [backend.main] Session validation middleware added.
2025-01-26 20:41:22,367 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 20:41:22,367 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 20:41:22,367 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 20:41:22,367 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 20:41:22,370 [INFO] [backend.main] Auth router registered.
2025-01-26 20:41:22,378 [INFO] [backend.main] User router registered.
2025-01-26 20:41:22,382 [INFO] [backend.main] Workout router registered.
2025-01-26 20:41:22,390 [INFO] [backend.main] Payment router registered.
2025-01-26 20:41:22,397 [INFO] [backend.main] Subscription router registered.
2025-01-26 20:41:22,397 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 20:41:22,400 [INFO] [backend.main] Admin router registered.
2025-01-26 20:41:22,563 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,567 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-26 20:41:22,567 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-26 20:41:22,567 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,570 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-26 20:41:22,876 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,879 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-26 20:41:22,879 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-26 20:41:22,879 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,879 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-26 20:41:22,886 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,890 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/reset-mfa
2025-01-26 20:41:22,890 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/reset-mfa
2025-01-26 20:41:22,890 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,892 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/reset-mfa "HTTP/1.1 401 Unauthorized"
2025-01-26 20:41:22,898 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,901 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-26 20:41:22,901 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-26 20:41:22,901 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,901 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-26 20:41:22,909 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,910 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-26 20:41:22,910 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-26 20:41:22,910 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,912 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-26 20:41:22,919 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,919 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-26 20:41:22,919 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-26 20:41:22,919 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,923 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-26 20:41:22,929 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 20:41:22,929 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/sessions
2025-01-26 20:41:22,929 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/sessions
2025-01-26 20:41:22,929 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-26 20:41:22,932 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/sessions "HTTP/1.1 401 Unauthorized"
2025-01-26 21:00:35,882 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:00:39,935 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:19:35,552 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:19:38,939 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:20:16,705 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:21:23,767 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:21:24,431 [INFO] [backend.main] Session validation middleware added.
2025-01-26 21:21:24,431 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 21:21:24,431 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 21:21:24,431 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 21:21:24,431 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 21:21:24,435 [INFO] [backend.main] Auth router registered.
2025-01-26 21:21:24,440 [INFO] [backend.main] User router registered.
2025-01-26 21:21:24,443 [INFO] [backend.main] Workout router registered.
2025-01-26 21:21:24,453 [INFO] [backend.main] Payment router registered.
2025-01-26 21:21:24,459 [INFO] [backend.main] Subscription router registered.
2025-01-26 21:21:24,459 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 21:21:24,462 [INFO] [backend.main] Admin router registered.
2025-01-26 21:21:24,613 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:24,615 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:24,616 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:24,616 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 21:21:24,616 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:24,616 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/
2025-01-26 21:21:24,618 [INFO] [backend.api.subscriptions.subscription_routes] Listing subscription tiers.
2025-01-26 21:21:24,675 [DEBUG] [backend.api.subscriptions.subscription_service] Fetched subscription tiers: [<backend.models.subscription_tier.SubscriptionTier object at 0x0000024556576000>, <backend.models.subscription_tier.SubscriptionTier object at 0x0000024556575FA0>, <backend.models.subscription_tier.SubscriptionTier object at 0x0000024556575F70>]
2025-01-26 21:21:24,676 [INFO] [backend.main] Response status: 200
2025-01-26 21:21:24,678 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/ "HTTP/1.1 200 OK"
2025-01-26 21:21:24,994 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:24,995 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/a4b59884-3cc4-424b-b719-d7ecda5bed70
2025-01-26 21:21:24,995 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/a4b59884-3cc4-424b-b719-d7ecda5bed70
2025-01-26 21:21:24,995 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/a4b59884-3cc4-424b-b719-d7ecda5bed70
2025-01-26 21:21:24,995 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/a4b59884-3cc4-424b-b719-d7ecda5bed70
2025-01-26 21:21:24,995 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/a4b59884-3cc4-424b-b719-d7ecda5bed70
2025-01-26 21:21:24,997 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: a4b59884-3cc4-424b-b719-d7ecda5bed70
2025-01-26 21:21:25,000 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier a4b59884-3cc4-424b-b719-d7ecda5bed70: 404: Subscription tier not found.
2025-01-26 21:21:25,001 [INFO] [backend.main] Response status: 500
2025-01-26 21:21:25,003 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/a4b59884-3cc4-424b-b719-d7ecda5bed70 "HTTP/1.1 500 Internal Server Error"
2025-01-26 21:21:25,010 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:25,011 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:25,012 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:25,012 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 21:21:25,012 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:25,012 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-26 21:21:25,020 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:25,021 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:25,031 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:25,032 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/8ab6f64e-d508-46ba-885b-8b4f34e0d911
2025-01-26 21:21:25,033 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/8ab6f64e-d508-46ba-885b-8b4f34e0d911
2025-01-26 21:21:25,033 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/8ab6f64e-d508-46ba-885b-8b4f34e0d911
2025-01-26 21:21:25,033 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/8ab6f64e-d508-46ba-885b-8b4f34e0d911
2025-01-26 21:21:25,033 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/8ab6f64e-d508-46ba-885b-8b4f34e0d911
2025-01-26 21:21:25,036 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:25,037 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/8ab6f64e-d508-46ba-885b-8b4f34e0d911 "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:25,046 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:25,048 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/131164bd-da1d-40f8-9d08-27f5c216ebf0
2025-01-26 21:21:25,048 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/131164bd-da1d-40f8-9d08-27f5c216ebf0
2025-01-26 21:21:25,048 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/131164bd-da1d-40f8-9d08-27f5c216ebf0
2025-01-26 21:21:25,048 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/131164bd-da1d-40f8-9d08-27f5c216ebf0
2025-01-26 21:21:25,049 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/131164bd-da1d-40f8-9d08-27f5c216ebf0
2025-01-26 21:21:25,050 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:25,051 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/131164bd-da1d-40f8-9d08-27f5c216ebf0 "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:25,061 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:25,063 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/95d8f855-3390-4da8-877f-1dba9154465e/deactivate
2025-01-26 21:21:25,063 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/95d8f855-3390-4da8-877f-1dba9154465e/deactivate
2025-01-26 21:21:25,063 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/95d8f855-3390-4da8-877f-1dba9154465e/deactivate
2025-01-26 21:21:25,063 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/95d8f855-3390-4da8-877f-1dba9154465e/deactivate
2025-01-26 21:21:25,063 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/95d8f855-3390-4da8-877f-1dba9154465e/deactivate
2025-01-26 21:21:25,064 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:25,066 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/95d8f855-3390-4da8-877f-1dba9154465e/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:28,298 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-26 21:21:28,751 [INFO] [backend.main] Session validation middleware added.
2025-01-26 21:21:28,751 [INFO] [backend.main] MFA validation middleware added.
2025-01-26 21:21:28,751 [INFO] [backend.main] Admin validation middleware added.
2025-01-26 21:21:28,751 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-26 21:21:28,751 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-26 21:21:28,755 [INFO] [backend.main] Auth router registered.
2025-01-26 21:21:28,760 [INFO] [backend.main] User router registered.
2025-01-26 21:21:28,763 [INFO] [backend.main] Workout router registered.
2025-01-26 21:21:28,772 [INFO] [backend.main] Payment router registered.
2025-01-26 21:21:28,778 [INFO] [backend.main] Subscription router registered.
2025-01-26 21:21:28,778 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-26 21:21:28,781 [INFO] [backend.main] Admin router registered.
2025-01-26 21:21:28,927 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:28,929 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:28,929 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:28,929 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 21:21:28,930 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:28,930 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/
2025-01-26 21:21:28,932 [INFO] [backend.api.subscriptions.subscription_routes] Listing subscription tiers.
2025-01-26 21:21:28,984 [DEBUG] [backend.api.subscriptions.subscription_service] Fetched subscription tiers: [<backend.models.subscription_tier.SubscriptionTier object at 0x000002335D996000>, <backend.models.subscription_tier.SubscriptionTier object at 0x000002335D49FAD0>, <backend.models.subscription_tier.SubscriptionTier object at 0x000002335D995FA0>]
2025-01-26 21:21:28,986 [INFO] [backend.main] Response status: 200
2025-01-26 21:21:28,988 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/ "HTTP/1.1 200 OK"
2025-01-26 21:21:29,321 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:29,323 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/63dd100b-dbdc-434a-97d4-9bbf02e6e49d
2025-01-26 21:21:29,323 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/63dd100b-dbdc-434a-97d4-9bbf02e6e49d
2025-01-26 21:21:29,323 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/63dd100b-dbdc-434a-97d4-9bbf02e6e49d
2025-01-26 21:21:29,324 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/63dd100b-dbdc-434a-97d4-9bbf02e6e49d
2025-01-26 21:21:29,324 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/63dd100b-dbdc-434a-97d4-9bbf02e6e49d
2025-01-26 21:21:29,326 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: 63dd100b-dbdc-434a-97d4-9bbf02e6e49d
2025-01-26 21:21:29,329 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier 63dd100b-dbdc-434a-97d4-9bbf02e6e49d: 404: Subscription tier not found.
2025-01-26 21:21:29,330 [INFO] [backend.main] Response status: 500
2025-01-26 21:21:29,332 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/63dd100b-dbdc-434a-97d4-9bbf02e6e49d "HTTP/1.1 500 Internal Server Error"
2025-01-26 21:21:29,340 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:29,342 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:29,342 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:29,342 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-26 21:21:29,343 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-26 21:21:29,343 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-26 21:21:29,352 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:29,353 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:29,362 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:29,363 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/a1aa51c3-6c5f-4366-a5d9-7c12b3afd132
2025-01-26 21:21:29,364 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/a1aa51c3-6c5f-4366-a5d9-7c12b3afd132
2025-01-26 21:21:29,364 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/a1aa51c3-6c5f-4366-a5d9-7c12b3afd132
2025-01-26 21:21:29,364 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/a1aa51c3-6c5f-4366-a5d9-7c12b3afd132
2025-01-26 21:21:29,365 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/a1aa51c3-6c5f-4366-a5d9-7c12b3afd132
2025-01-26 21:21:29,367 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:29,368 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/a1aa51c3-6c5f-4366-a5d9-7c12b3afd132 "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:29,378 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:29,379 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/ad8eb8b9-da13-4c7f-8b2b-f1a934c5343d
2025-01-26 21:21:29,380 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/ad8eb8b9-da13-4c7f-8b2b-f1a934c5343d
2025-01-26 21:21:29,380 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/ad8eb8b9-da13-4c7f-8b2b-f1a934c5343d
2025-01-26 21:21:29,380 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/ad8eb8b9-da13-4c7f-8b2b-f1a934c5343d
2025-01-26 21:21:29,380 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/ad8eb8b9-da13-4c7f-8b2b-f1a934c5343d
2025-01-26 21:21:29,382 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:29,383 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/ad8eb8b9-da13-4c7f-8b2b-f1a934c5343d "HTTP/1.1 422 Unprocessable Entity"
2025-01-26 21:21:29,392 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-26 21:21:29,393 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/551ce516-551b-4ae3-b97e-b5112df1a2cf/deactivate
2025-01-26 21:21:29,393 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/551ce516-551b-4ae3-b97e-b5112df1a2cf/deactivate
2025-01-26 21:21:29,393 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/551ce516-551b-4ae3-b97e-b5112df1a2cf/deactivate
2025-01-26 21:21:29,393 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/551ce516-551b-4ae3-b97e-b5112df1a2cf/deactivate
2025-01-26 21:21:29,394 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/551ce516-551b-4ae3-b97e-b5112df1a2cf/deactivate
2025-01-26 21:21:29,395 [INFO] [backend.main] Response status: 422
2025-01-26 21:21:29,396 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/551ce516-551b-4ae3-b97e-b5112df1a2cf/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 08:50:59,990 [INFO] [backend.api.subscriptions.subscription_service] Fetching subscription details for user ID 656bd0a1-cb2a-4255-bc4e-70e69c8af09a
2025-01-27 08:50:59,995 [WARNING] [backend.api.subscriptions.subscription_service] Subscription tier not found for user ID 656bd0a1-cb2a-4255-bc4e-70e69c8af09a
2025-01-27 08:51:00,215 [INFO] [backend.api.subscriptions.subscription_service] Updating subscription for user ID 9cea8fee-83aa-4978-a676-4dec8491dad6
2025-01-27 08:51:00,233 [INFO] [backend.api.subscriptions.subscription_service] Cancelling subscription for user ID ed8fc1d3-78c3-41b8-8be0-5393c0ea1911
2025-01-27 09:12:42,713 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-27 09:12:42,713 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-27 09:12:42,713 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-27 09:12:42,722 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-27 09:12:43,279 [INFO] [backend.main] Session validation middleware added.
2025-01-27 09:12:43,279 [INFO] [backend.main] MFA validation middleware added.
2025-01-27 09:12:43,279 [INFO] [backend.main] Admin validation middleware added.
2025-01-27 09:12:43,279 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-27 09:12:43,279 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-27 09:12:43,285 [INFO] [backend.main] Auth router registered.
2025-01-27 09:12:43,291 [INFO] [backend.main] User router registered.
2025-01-27 09:12:43,291 [INFO] [backend.main] Workout router registered.
2025-01-27 09:12:43,298 [INFO] [backend.main] Payment router registered.
2025-01-27 09:12:43,305 [INFO] [backend.main] Subscription router registered.
2025-01-27 09:12:43,305 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-27 09:12:43,310 [INFO] [backend.main] Admin router registered.
2025-01-27 09:12:43,681 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:43,684 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-27 09:12:43,684 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-27 09:12:43,684 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-27 09:12:43,990 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:43,993 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/login
2025-01-27 09:12:43,993 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/login
2025-01-27 09:12:43,993 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/login
2025-01-27 09:12:43,993 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/login
2025-01-27 09:12:43,993 [INFO] [backend.main] Processing request POST http://testserver/api/admin/login
2025-01-27 09:12:44,000 [DEBUG] [backend.api.admin.admin_routes] Attempting to log in admin: admin@example.com
2025-01-27 09:12:44,055 [WARNING] [backend.api.admin.admin_routes] Invalid login attempt for email: admin@example.com
2025-01-27 09:12:44,055 [ERROR] [backend.api.admin.admin_routes] Unexpected error during login: 401: Invalid email or password
2025-01-27 09:12:44,057 [INFO] [backend.main] Response status: 500
2025-01-27 09:12:44,058 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/login "HTTP/1.1 500 Internal Server Error"
2025-01-27 09:12:44,068 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,070 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 09:12:44,071 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 09:12:44,071 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/setup
2025-01-27 09:12:44,071 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 09:12:44,071 [INFO] [backend.main] Processing request GET http://testserver/api/admin/mfa/setup?user_id=01725a7a-6366-4ee2-9464-52ba6f9ca714
2025-01-27 09:12:44,074 [INFO] [backend.main] Response status: 403
2025-01-27 09:12:44,074 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/mfa/setup?user_id=01725a7a-6366-4ee2-9464-52ba6f9ca714 "HTTP/1.1 403 Forbidden"
2025-01-27 09:12:44,085 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,087 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 09:12:44,087 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 09:12:44,087 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/verify
2025-01-27 09:12:44,087 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 09:12:44,087 [INFO] [backend.main] Processing request POST http://testserver/api/admin/mfa/verify
2025-01-27 09:12:44,090 [DEBUG] [backend.api.admin.admin_routes] User MFA verify: user_id=8923bc6d-6900-4ee1-b539-2feaea7aa601, totp_code=123456
2025-01-27 09:12:44,090 [DEBUG] [backend.services.session_service] Validating session token: test-session-token
2025-01-27 09:12:44,094 [WARNING] [backend.services.session_service] Session token not found: test-session-token
2025-01-27 09:12:44,094 [ERROR] [backend.api.admin.admin_routes] MFA verification error: 401: Session not found
2025-01-27 09:12:44,094 [INFO] [backend.main] Response status: 401
2025-01-27 09:12:44,096 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/mfa/verify "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:44,105 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,107 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/list
2025-01-27 09:12:44,107 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-27 09:12:44,108 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/list "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:44,114 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,116 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-27 09:12:44,116 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-27 09:12:44,117 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:44,122 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 09:12:44,123 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-27 09:12:44,123 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-27 09:12:44,123 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-27 09:12:44,335 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: e6d327fc-ebff-4673-a7f9-4b795715d422)
2025-01-27 09:12:44,339 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 09:12:44,533 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: c0a572e3-94b8-4d63-bf02-ae21422a5cfc)
2025-01-27 09:12:44,534 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 09:12:44,726 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: becdc434-ac79-44ae-8e12-71025336f2af)
2025-01-27 09:12:44,727 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-27 09:12:44,737 [INFO] [backend.api.admin.admin_service] Retrieved 1 flagged users
2025-01-27 09:12:44,741 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,743 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-27 09:12:44,743 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-27 09:12:44,743 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-27 09:12:44,743 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-27 09:12:44,743 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-27 09:12:44,755 [ERROR] [backend.api.auth.auth_routes] Registration failed: Username already registered
2025-01-27 09:12:44,756 [INFO] [backend.main] Response status: 400
2025-01-27 09:12:44,756 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
2025-01-27 09:12:44,767 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,768 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/login
2025-01-27 09:12:44,770 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/login
2025-01-27 09:12:44,770 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/login
2025-01-27 09:12:44,770 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/login
2025-01-27 09:12:44,770 [INFO] [backend.main] Processing request POST http://testserver/api/auth/login
2025-01-27 09:12:44,771 [INFO] [backend.api.auth.auth_routes] Login attempt for email: testuser@example.com, is_mobile: False
2025-01-27 09:12:44,774 [WARNING] [backend.api.auth.auth_routes] User with email testuser@example.com not found
2025-01-27 09:12:44,774 [INFO] [backend.main] Response status: 401
2025-01-27 09:12:44,774 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:44,784 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,784 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/verify-email
2025-01-27 09:12:44,788 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/verify-email
2025-01-27 09:12:44,788 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/verify-email
2025-01-27 09:12:44,788 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/verify-email
2025-01-27 09:12:44,788 [INFO] [backend.main] Processing request GET http://testserver/api/auth/verify-email?token=fake-token
2025-01-27 09:12:44,789 [ERROR] [backend.api.auth.auth_routes] Error during email verification
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\backend\api\auth\auth_routes.py", line 184, in verify_email
    raise HTTPException(status_code=404, detail="User not found")
fastapi.exceptions.HTTPException: 404: User not found
2025-01-27 09:12:44,791 [INFO] [backend.main] Response status: 307
2025-01-27 09:12:44,791 [INFO] [httpx] HTTP Request: GET http://testserver/api/auth/verify-email?token=fake-token "HTTP/1.1 307 Temporary Redirect"
2025-01-27 09:12:44,791 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,794 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /verify-email
2025-01-27 09:12:44,794 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /verify-email
2025-01-27 09:12:44,794 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:44,794 [INFO] [httpx] HTTP Request: GET http://localhost:3000/verify-email?status=error "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:44,804 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,804 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 09:12:44,804 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 09:12:44,804 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/resend-verification
2025-01-27 09:12:44,804 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 09:12:44,804 [INFO] [backend.main] Processing request POST http://testserver/api/auth/resend-verification
2025-01-27 09:12:44,807 [INFO] [backend.main] Response status: 422
2025-01-27 09:12:44,807 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/resend-verification "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 09:12:44,817 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,819 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout
2025-01-27 09:12:44,819 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout
2025-01-27 09:12:44,819 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout
2025-01-27 09:12:44,819 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout
2025-01-27 09:12:44,820 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout
2025-01-27 09:12:44,820 [INFO] [backend.main] Response status: 403
2025-01-27 09:12:44,822 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
2025-01-27 09:12:44,830 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:44,832 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout-all
2025-01-27 09:12:44,832 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout-all
2025-01-27 09:12:44,832 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout-all
2025-01-27 09:12:44,832 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout-all
2025-01-27 09:12:44,832 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout-all
2025-01-27 09:12:44,833 [INFO] [backend.main] Response status: 422
2025-01-27 09:12:44,835 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout-all "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 09:12:45,041 [INFO] [backend.api.auth.auth_service] User created: ID=98c252c1-bcff-45b9-98c3-477d95cf20ff, username=testuser
2025-01-27 09:12:45,924 [INFO] [backend.api.auth.auth_service] User created: ID=7f2d2cc9-20f1-48a3-b8c6-253bfb3b595f, username=testuser
2025-01-27 09:12:46,114 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-27 09:12:46,317 [INFO] [backend.api.auth.auth_service] User created: ID=9e719e1e-3845-4e75-ad01-7f46e00cd067, username=testuser
2025-01-27 09:12:46,513 [INFO] [backend.api.auth.auth_service] User created: ID=3482eb07-e422-4b8a-a2ce-d473fb270223, username=testuser
2025-01-27 09:12:46,514 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-27 09:12:46,707 [INFO] [backend.api.auth.auth_service] User created: ID=c069503c-864e-4194-ad62-59d1bbb202a0, username=testuser
2025-01-27 09:12:46,895 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-27 09:12:46,898 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-27 09:12:46,932 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-27 09:12:46,937 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-27 09:12:46,942 [INFO] [backend.services.mfa] Resetting MFA for user_id: e0b50730-3862-44c1-a8f7-729881aacae8
2025-01-27 09:12:46,948 [INFO] [backend.services.mfa] MFA reset successfully for user_id: e0b50730-3862-44c1-a8f7-729881aacae8
2025-01-27 09:12:46,952 [INFO] [backend.services.mfa] Resetting MFA for user_id: 77b7e84a-f1f0-4b19-bee7-b1ba952df282
2025-01-27 09:12:46,953 [ERROR] [backend.services.mfa] User not found for MFA reset: 77b7e84a-f1f0-4b19-bee7-b1ba952df282
2025-01-27 09:12:46,957 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:46,961 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/create
2025-01-27 09:12:46,961 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/create
2025-01-27 09:12:46,961 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/create
2025-01-27 09:12:46,961 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/create
2025-01-27 09:12:46,961 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 09:12:46,962 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/create?subscription_tier=tier-id-123 "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:47,474 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:47,474 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/history
2025-01-27 09:12:47,474 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/history
2025-01-27 09:12:47,474 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:47,476 [INFO] [httpx] HTTP Request: GET http://testserver/api/payments/history?page=1&page_size=10 "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:47,485 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:47,486 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/create
2025-01-27 09:12:47,486 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/create
2025-01-27 09:12:47,486 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/create
2025-01-27 09:12:47,486 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/create
2025-01-27 09:12:47,486 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 09:12:47,487 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/create?subscription_tier=invalid-tier-id "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:47,501 [INFO] [backend.api.payments.payment_service] Creating Stripe payment for user 00a03618-ba04-4c99-bc3c-16439e6b8f6b, subscription tier ID: 6afd7c9a-c2b8-4415-b45f-0400a3a0d5d7
2025-01-27 09:12:47,504 [ERROR] [backend.api.payments.payment_service] Error creating Stripe session: 'dict' object has no attribute 'id'
2025-01-27 09:12:48,258 [INFO] [backend.services.session_service] Creating or fetching session for user_id: c343c3e0-1263-4751-8dae-0856433670c6, is_mobile: False
2025-01-27 09:12:48,261 [DEBUG] [backend.services.session_service] Generated session token: f260e017-c4e6-47ff-a245-0ad410dc8808
2025-01-27 09:12:48,261 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 16:12:48.261777
2025-01-27 09:12:48,264 [INFO] [backend.services.session_service] New session created for user_id: c343c3e0-1263-4751-8dae-0856433670c6, session_id: 4c297294-a86e-491f-8bca-d941856d848d
2025-01-27 09:12:48,274 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 756aa194-190e-4992-9307-bdc9501eeead, is_mobile: False
2025-01-27 09:12:48,274 [DEBUG] [backend.services.session_service] Generated session token: 578a0550-9f86-4a9d-80db-07664b6d79c1
2025-01-27 09:12:48,274 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 16:12:48.274924
2025-01-27 09:12:48,274 [INFO] [backend.services.session_service] New session created for user_id: 756aa194-190e-4992-9307-bdc9501eeead, session_id: f90ecdc0-cdbf-4c52-be49-d7e0383941a3
2025-01-27 09:12:48,284 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 53d76e3a-85df-4794-86e5-c91d8003847d, is_mobile: False
2025-01-27 09:12:48,286 [DEBUG] [backend.services.session_service] Generated session token: 86a91a39-05ac-49f7-a534-00f97d385bee
2025-01-27 09:12:48,286 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 16:12:48.286467
2025-01-27 09:12:48,287 [INFO] [backend.services.session_service] New session created for user_id: 53d76e3a-85df-4794-86e5-c91d8003847d, session_id: 7a2e6ccb-72f6-43d7-870a-2f4357e808a1
2025-01-27 09:12:48,296 [INFO] [backend.services.session_service] Creating or fetching session for user_id: c2e200e3-86c8-4006-958d-9cf379532532, is_mobile: False
2025-01-27 09:12:48,296 [DEBUG] [backend.services.session_service] Generated session token: a0cfe2f0-e116-490e-acc8-19586f7be531
2025-01-27 09:12:48,296 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 16:12:48.296945
2025-01-27 09:12:48,296 [INFO] [backend.services.session_service] New session created for user_id: c2e200e3-86c8-4006-958d-9cf379532532, session_id: 04c9e519-2bb6-4a73-8311-feb93f10f2c8
2025-01-27 09:12:48,299 [INFO] [backend.services.session_service] Creating or fetching session for user_id: c2e200e3-86c8-4006-958d-9cf379532532, is_mobile: True
2025-01-27 09:12:48,300 [DEBUG] [backend.services.session_service] Generated session token: 7a89750e-7c84-41e3-b493-e27348beef8d
2025-01-27 09:12:48,300 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 16:12:48.300835
2025-01-27 09:12:48,300 [INFO] [backend.services.session_service] New session created for user_id: c2e200e3-86c8-4006-958d-9cf379532532, session_id: 9c50118a-c77f-443e-8d6f-83e8a4d2cdbf
2025-01-27 09:12:48,302 [INFO] [backend.services.session_service] Invalidating sessions for user_id: c2e200e3-86c8-4006-958d-9cf379532532, is_mobile: None
2025-01-27 09:12:48,302 [INFO] [backend.services.session_service] Invalidated 2 session(s) for user_id: c2e200e3-86c8-4006-958d-9cf379532532
2025-01-27 09:12:48,308 [INFO] [backend.services.session_service] Creating or fetching session for user_id: c378240c-528c-41d9-81e4-72aed47e16c6, is_mobile: False
2025-01-27 09:12:48,308 [DEBUG] [backend.services.session_service] Generated session token: 0d137dff-1175-41f5-880a-c1a580669a76
2025-01-27 09:12:48,308 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 16:12:48.308915
2025-01-27 09:12:48,308 [INFO] [backend.services.session_service] New session created for user_id: c378240c-528c-41d9-81e4-72aed47e16c6, session_id: e47dd10f-edb0-43b9-830c-c31d8b3009af
2025-01-27 09:12:48,311 [INFO] [backend.services.session_service] Creating or fetching session for user_id: c378240c-528c-41d9-81e4-72aed47e16c6, is_mobile: True
2025-01-27 09:12:48,311 [DEBUG] [backend.services.session_service] Generated session token: 70f7fc44-b578-4f94-abeb-5b919c064374
2025-01-27 09:12:48,311 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 16:12:48.311933
2025-01-27 09:12:48,311 [INFO] [backend.services.session_service] New session created for user_id: c378240c-528c-41d9-81e4-72aed47e16c6, session_id: cf82a762-1007-46f8-aae3-2b563650d3c1
2025-01-27 09:12:48,311 [DEBUG] [backend.services.session_service] Fetching active sessions for user_id: c378240c-528c-41d9-81e4-72aed47e16c6, is_mobile: None
2025-01-27 09:12:48,314 [INFO] [backend.services.session_service] Retrieved 2 active session(s) for user_id: c378240c-528c-41d9-81e4-72aed47e16c6
2025-01-27 09:12:48,318 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 201c07a8-5070-46c6-8ae6-b36cc289229a, is_mobile: False
2025-01-27 09:12:48,318 [DEBUG] [backend.services.session_service] Generated session token: 5db34d87-914f-4709-8d80-9380381d5140
2025-01-27 09:12:48,318 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 16:12:48.318325
2025-01-27 09:12:48,320 [INFO] [backend.services.session_service] New session created for user_id: 201c07a8-5070-46c6-8ae6-b36cc289229a, session_id: 19c3b884-380a-4c32-a836-3626a19617b2
2025-01-27 09:12:48,321 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 201c07a8-5070-46c6-8ae6-b36cc289229a, is_mobile: True
2025-01-27 09:12:48,321 [DEBUG] [backend.services.session_service] Generated session token: f352fd9f-6398-462b-be82-bd887145d886
2025-01-27 09:12:48,321 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 16:12:48.321336
2025-01-27 09:12:48,321 [INFO] [backend.services.session_service] New session created for user_id: 201c07a8-5070-46c6-8ae6-b36cc289229a, session_id: 3c5ee0ca-4a9d-4a54-9cbe-49b364074331
2025-01-27 09:12:48,321 [INFO] [backend.services.session_service] Fetching active sessions for user_id: 201c07a8-5070-46c6-8ae6-b36cc289229a
2025-01-27 09:12:48,321 [INFO] [backend.services.session_service] Fetched 2 session(s) for user_id: 201c07a8-5070-46c6-8ae6-b36cc289229a
2025-01-27 09:12:48,328 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,330 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-27 09:12:48,330 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-27 09:12:48,331 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,331 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,340 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,340 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-27 09:12:48,340 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-27 09:12:48,340 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,340 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,350 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,350 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/reset-mfa
2025-01-27 09:12:48,352 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/reset-mfa
2025-01-27 09:12:48,352 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,352 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/reset-mfa "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,358 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,362 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 09:12:48,362 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 09:12:48,362 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,362 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,370 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,373 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 09:12:48,373 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 09:12:48,373 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,374 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,380 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,383 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 09:12:48,383 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 09:12:48,383 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,383 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,392 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,394 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/sessions
2025-01-27 09:12:48,394 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/sessions
2025-01-27 09:12:48,394 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,396 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/sessions "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,402 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,402 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-27 09:12:48,405 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-27 09:12:48,405 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-27 09:12:48,405 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-27 09:12:48,405 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/
2025-01-27 09:12:48,406 [INFO] [backend.api.subscriptions.subscription_routes] Listing subscription tiers.
2025-01-27 09:12:48,411 [DEBUG] [backend.api.subscriptions.subscription_service] Fetched subscription tiers: [<backend.models.subscription_tier.SubscriptionTier object at 0x00000299ACF99610>, <backend.models.subscription_tier.SubscriptionTier object at 0x00000299ACF995B0>, <backend.models.subscription_tier.SubscriptionTier object at 0x00000299ACF99580>]
2025-01-27 09:12:48,413 [INFO] [backend.main] Response status: 200
2025-01-27 09:12:48,415 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/ "HTTP/1.1 200 OK"
2025-01-27 09:12:48,424 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,424 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/5e7854ee-5b30-4f91-93fd-ebd2f8a9f263
2025-01-27 09:12:48,424 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/5e7854ee-5b30-4f91-93fd-ebd2f8a9f263
2025-01-27 09:12:48,424 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/5e7854ee-5b30-4f91-93fd-ebd2f8a9f263
2025-01-27 09:12:48,426 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/5e7854ee-5b30-4f91-93fd-ebd2f8a9f263
2025-01-27 09:12:48,426 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/5e7854ee-5b30-4f91-93fd-ebd2f8a9f263
2025-01-27 09:12:48,427 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: 5e7854ee-5b30-4f91-93fd-ebd2f8a9f263
2025-01-27 09:12:48,427 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier 5e7854ee-5b30-4f91-93fd-ebd2f8a9f263: 404: Subscription tier not found.
2025-01-27 09:12:48,427 [INFO] [backend.main] Response status: 500
2025-01-27 09:12:48,430 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/5e7854ee-5b30-4f91-93fd-ebd2f8a9f263 "HTTP/1.1 500 Internal Server Error"
2025-01-27 09:12:48,438 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,440 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-27 09:12:48,440 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-27 09:12:48,440 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-27 09:12:48,440 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-27 09:12:48,441 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-27 09:12:48,449 [INFO] [backend.main] Response status: 422
2025-01-27 09:12:48,449 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 09:12:48,459 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,459 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/08f22d3b-b456-48ca-85f0-0856cce1143f
2025-01-27 09:12:48,459 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/08f22d3b-b456-48ca-85f0-0856cce1143f
2025-01-27 09:12:48,459 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/08f22d3b-b456-48ca-85f0-0856cce1143f
2025-01-27 09:12:48,462 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/08f22d3b-b456-48ca-85f0-0856cce1143f
2025-01-27 09:12:48,462 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/08f22d3b-b456-48ca-85f0-0856cce1143f
2025-01-27 09:12:48,465 [INFO] [backend.main] Response status: 422
2025-01-27 09:12:48,465 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/08f22d3b-b456-48ca-85f0-0856cce1143f "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 09:12:48,475 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,475 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/baf67cc6-b443-4a36-9b79-5bde83c4c2ab
2025-01-27 09:12:48,475 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/baf67cc6-b443-4a36-9b79-5bde83c4c2ab
2025-01-27 09:12:48,475 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/baf67cc6-b443-4a36-9b79-5bde83c4c2ab
2025-01-27 09:12:48,478 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/baf67cc6-b443-4a36-9b79-5bde83c4c2ab
2025-01-27 09:12:48,478 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/baf67cc6-b443-4a36-9b79-5bde83c4c2ab
2025-01-27 09:12:48,479 [INFO] [backend.main] Response status: 422
2025-01-27 09:12:48,481 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/baf67cc6-b443-4a36-9b79-5bde83c4c2ab "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 09:12:48,487 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,491 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/47c78ad6-da5b-4412-9ae0-8929421871ab/deactivate
2025-01-27 09:12:48,491 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/47c78ad6-da5b-4412-9ae0-8929421871ab/deactivate
2025-01-27 09:12:48,491 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/47c78ad6-da5b-4412-9ae0-8929421871ab/deactivate
2025-01-27 09:12:48,491 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/47c78ad6-da5b-4412-9ae0-8929421871ab/deactivate
2025-01-27 09:12:48,491 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/47c78ad6-da5b-4412-9ae0-8929421871ab/deactivate
2025-01-27 09:12:48,491 [INFO] [backend.main] Response status: 422
2025-01-27 09:12:48,494 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/47c78ad6-da5b-4412-9ae0-8929421871ab/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 09:12:48,507 [INFO] [backend.api.subscriptions.subscription_service] Fetching subscription details for user ID 191d312e-83c7-4ae2-be34-924295078af1
2025-01-27 09:12:48,507 [WARNING] [backend.api.subscriptions.subscription_service] Subscription tier not found for user ID 191d312e-83c7-4ae2-be34-924295078af1
2025-01-27 09:12:48,523 [INFO] [backend.api.subscriptions.subscription_service] Updating subscription for user ID 7f568ba0-ab9f-49e5-a91b-87f860d030a3
2025-01-27 09:12:48,541 [INFO] [backend.api.subscriptions.subscription_service] Cancelling subscription for user ID db7da45f-73fb-48ec-b46e-14483391ba11
2025-01-27 09:12:48,560 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,560 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-27 09:12:48,560 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-27 09:12:48,560 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,560 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,569 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,571 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-27 09:12:48,571 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-27 09:12:48,571 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,572 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,578 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,581 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-27 09:12:48,581 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-27 09:12:48,581 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,581 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,590 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,590 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-27 09:12:48,590 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-27 09:12:48,593 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,593 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,604 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,606 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-27 09:12:48,606 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-27 09:12:48,606 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,606 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=6209e538-59fc-4392-aa2a-299ed4f5b722 "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,615 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 09:12:48,615 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-27 09:12:48,617 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-27 09:12:48,617 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 09:12:48,618 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-27 09:12:48,832 [INFO] [backend.api.auth.auth_service] User created: ID=fcbf3377-5ce5-484d-8cb2-cc4a57b5be3b, username=testuser
2025-01-27 09:12:49,032 [INFO] [backend.api.auth.auth_service] User created: ID=ed437ea4-50b9-47ea-9e03-225d9628676b, username=testuser
2025-01-27 09:12:49,229 [INFO] [backend.api.auth.auth_service] User created: ID=7c0158b1-e56d-4d1f-8f60-3b72ee86dc5f, username=testuser
2025-01-27 09:12:49,421 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-27 10:19:29,014 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-27 10:19:29,014 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-27 10:19:29,014 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-27 10:19:29,021 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-27 10:19:29,430 [INFO] [backend.main] Session validation middleware added.
2025-01-27 10:19:29,430 [INFO] [backend.main] MFA validation middleware added.
2025-01-27 10:19:29,431 [INFO] [backend.main] Admin validation middleware added.
2025-01-27 10:19:29,431 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-27 10:19:29,431 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-27 10:19:29,435 [INFO] [backend.main] Auth router registered.
2025-01-27 10:19:29,440 [INFO] [backend.main] User router registered.
2025-01-27 10:19:29,443 [INFO] [backend.main] Workout router registered.
2025-01-27 10:19:29,450 [INFO] [backend.main] Payment router registered.
2025-01-27 10:19:29,456 [INFO] [backend.main] Subscription router registered.
2025-01-27 10:19:29,456 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-27 10:19:29,460 [INFO] [backend.main] Admin router registered.
2025-01-27 10:19:29,799 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:29,801 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-27 10:19:29,801 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-27 10:19:29,802 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-27 10:19:30,116 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,119 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/login
2025-01-27 10:19:30,119 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/login
2025-01-27 10:19:30,119 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/login
2025-01-27 10:19:30,119 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/login
2025-01-27 10:19:30,119 [INFO] [backend.main] Processing request POST http://testserver/api/admin/login
2025-01-27 10:19:30,126 [DEBUG] [backend.api.admin.admin_routes] Attempting to log in admin: admin@example.com
2025-01-27 10:19:30,190 [WARNING] [backend.api.admin.admin_routes] Invalid login attempt for email: admin@example.com
2025-01-27 10:19:30,190 [ERROR] [backend.api.admin.admin_routes] Unexpected error during login: 401: Invalid email or password
2025-01-27 10:19:30,192 [INFO] [backend.main] Response status: 500
2025-01-27 10:19:30,193 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/login "HTTP/1.1 500 Internal Server Error"
2025-01-27 10:19:30,202 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,204 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 10:19:30,204 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 10:19:30,204 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/setup
2025-01-27 10:19:30,204 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 10:19:30,204 [INFO] [backend.main] Processing request GET http://testserver/api/admin/mfa/setup?user_id=224d6b64-36fb-44f0-b14b-691be1b9060b
2025-01-27 10:19:30,208 [INFO] [backend.main] Response status: 403
2025-01-27 10:19:30,210 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/mfa/setup?user_id=224d6b64-36fb-44f0-b14b-691be1b9060b "HTTP/1.1 403 Forbidden"
2025-01-27 10:19:30,218 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,218 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 10:19:30,218 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 10:19:30,218 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/verify
2025-01-27 10:19:30,218 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 10:19:30,220 [INFO] [backend.main] Processing request POST http://testserver/api/admin/mfa/verify
2025-01-27 10:19:30,221 [DEBUG] [backend.api.admin.admin_routes] User MFA verify: user_id=1962a51f-3de7-42f0-982f-85ac09dd1a6f, totp_code=123456
2025-01-27 10:19:30,221 [DEBUG] [backend.services.session_service] Validating session token: test-session-token
2025-01-27 10:19:30,224 [WARNING] [backend.services.session_service] Session token not found: test-session-token
2025-01-27 10:19:30,224 [ERROR] [backend.api.admin.admin_routes] MFA verification error: 401: Session not found
2025-01-27 10:19:30,224 [INFO] [backend.main] Response status: 401
2025-01-27 10:19:30,226 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/mfa/verify "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:30,233 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,233 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/list
2025-01-27 10:19:30,233 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-27 10:19:30,237 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/list "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:30,243 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,244 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-27 10:19:30,244 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-27 10:19:30,244 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:30,252 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 10:19:30,252 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-27 10:19:30,253 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-27 10:19:30,253 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-27 10:19:30,466 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 98778ff3-bda3-4f7f-86e8-b0ddbfcb38ae)
2025-01-27 10:19:30,469 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 10:19:30,666 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: ef5a776a-95c0-4716-95cb-5f1176519b91)
2025-01-27 10:19:30,666 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 10:19:30,859 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: 7ae24fd7-f39e-4ae2-b1e6-48705d88e180)
2025-01-27 10:19:30,862 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-27 10:19:30,868 [INFO] [backend.api.admin.admin_service] Retrieved 1 flagged users
2025-01-27 10:19:30,871 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,874 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-27 10:19:30,874 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-27 10:19:30,874 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-27 10:19:30,874 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-27 10:19:30,874 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-27 10:19:30,884 [ERROR] [backend.api.auth.auth_routes] Registration failed: Username already registered
2025-01-27 10:19:30,886 [INFO] [backend.main] Response status: 400
2025-01-27 10:19:30,887 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
2025-01-27 10:19:30,896 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,896 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/login
2025-01-27 10:19:30,896 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/login
2025-01-27 10:19:30,896 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/login
2025-01-27 10:19:30,896 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/login
2025-01-27 10:19:30,896 [INFO] [backend.main] Processing request POST http://testserver/api/auth/login
2025-01-27 10:19:30,900 [INFO] [backend.api.auth.auth_routes] Login attempt for email: testuser@example.com, is_mobile: False
2025-01-27 10:19:30,902 [WARNING] [backend.api.auth.auth_routes] User with email testuser@example.com not found
2025-01-27 10:19:30,902 [INFO] [backend.main] Response status: 401
2025-01-27 10:19:30,902 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:30,913 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,913 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/verify-email
2025-01-27 10:19:30,913 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/verify-email
2025-01-27 10:19:30,913 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/verify-email
2025-01-27 10:19:30,915 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/verify-email
2025-01-27 10:19:30,915 [INFO] [backend.main] Processing request GET http://testserver/api/auth/verify-email?token=fake-token
2025-01-27 10:19:30,915 [ERROR] [backend.api.auth.auth_routes] Error during email verification
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\backend\api\auth\auth_routes.py", line 184, in verify_email
    raise HTTPException(status_code=404, detail="User not found")
fastapi.exceptions.HTTPException: 404: User not found
2025-01-27 10:19:30,919 [INFO] [backend.main] Response status: 307
2025-01-27 10:19:30,919 [INFO] [httpx] HTTP Request: GET http://testserver/api/auth/verify-email?token=fake-token "HTTP/1.1 307 Temporary Redirect"
2025-01-27 10:19:30,921 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,922 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /verify-email
2025-01-27 10:19:30,922 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /verify-email
2025-01-27 10:19:30,922 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:30,922 [INFO] [httpx] HTTP Request: GET http://localhost:3000/verify-email?status=error "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:30,933 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,934 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 10:19:30,934 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 10:19:30,934 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/resend-verification
2025-01-27 10:19:30,936 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 10:19:30,936 [INFO] [backend.main] Processing request POST http://testserver/api/auth/resend-verification
2025-01-27 10:19:30,936 [INFO] [backend.main] Response status: 422
2025-01-27 10:19:30,938 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/resend-verification "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:19:30,947 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,947 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout
2025-01-27 10:19:30,947 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout
2025-01-27 10:19:30,947 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout
2025-01-27 10:19:30,947 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout
2025-01-27 10:19:30,947 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout
2025-01-27 10:19:30,950 [INFO] [backend.main] Response status: 403
2025-01-27 10:19:30,950 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
2025-01-27 10:19:30,960 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:30,962 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout-all
2025-01-27 10:19:30,962 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout-all
2025-01-27 10:19:30,962 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout-all
2025-01-27 10:19:30,962 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout-all
2025-01-27 10:19:30,963 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout-all
2025-01-27 10:19:30,963 [INFO] [backend.main] Response status: 422
2025-01-27 10:19:30,966 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout-all "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:19:31,170 [INFO] [backend.api.auth.auth_service] User created: ID=3040d0f4-84c7-4ca5-befc-9fc836502b75, username=testuser
2025-01-27 10:19:31,950 [INFO] [backend.api.auth.auth_service] User created: ID=e2ff8f66-7e69-481e-8900-1d2225bc1532, username=testuser
2025-01-27 10:19:32,143 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-27 10:19:32,349 [INFO] [backend.api.auth.auth_service] User created: ID=590d05e2-0295-4edf-810d-386e82c8fce0, username=testuser
2025-01-27 10:19:32,546 [INFO] [backend.api.auth.auth_service] User created: ID=25180247-bbe3-4d5a-b6fb-f336e189762e, username=testuser
2025-01-27 10:19:32,546 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-27 10:19:32,742 [INFO] [backend.api.auth.auth_service] User created: ID=84958e07-ecd8-4830-a870-624355b69feb, username=testuser
2025-01-27 10:19:32,930 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-27 10:19:32,933 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-27 10:19:32,962 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-27 10:19:32,963 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-27 10:19:32,968 [INFO] [backend.services.mfa] Resetting MFA for user_id: 1fb9e2a3-ef27-4bc9-9e24-be7d10dc569a
2025-01-27 10:19:32,971 [INFO] [backend.services.mfa] MFA reset successfully for user_id: 1fb9e2a3-ef27-4bc9-9e24-be7d10dc569a
2025-01-27 10:19:32,974 [INFO] [backend.services.mfa] Resetting MFA for user_id: 6f611e4f-cb73-4df6-973f-8ba51c2e4f90
2025-01-27 10:19:32,974 [ERROR] [backend.services.mfa] User not found for MFA reset: 6f611e4f-cb73-4df6-973f-8ba51c2e4f90
2025-01-27 10:19:32,983 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:32,986 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/create
2025-01-27 10:19:32,986 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/create
2025-01-27 10:19:32,986 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/create
2025-01-27 10:19:32,986 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/create
2025-01-27 10:19:32,986 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 10:19:32,988 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/create?subscription_tier=19b2331e-7623-4ad0-a4e7-ccccf3361aec "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,004 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,006 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/verify
2025-01-27 10:19:33,006 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/verify
2025-01-27 10:19:33,006 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/verify
2025-01-27 10:19:33,006 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/verify
2025-01-27 10:19:33,006 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 10:19:33,006 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/verify?session_id=stripe-session-id "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,018 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,020 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/refund
2025-01-27 10:19:33,020 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/refund
2025-01-27 10:19:33,020 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,021 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/refund?payment_id=915c5fd4-846c-4127-8646-45e226f01e61 "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,030 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,031 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/history
2025-01-27 10:19:33,031 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/history
2025-01-27 10:19:33,031 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,033 [INFO] [httpx] HTTP Request: GET http://testserver/api/payments/history?page=1&page_size=10 "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,040 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,040 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/create
2025-01-27 10:19:33,040 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/create
2025-01-27 10:19:33,040 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/create
2025-01-27 10:19:33,040 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/create
2025-01-27 10:19:33,040 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 10:19:33,043 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/create?subscription_tier=invalid-tier-id "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,055 [INFO] [backend.api.payments.payment_service] Creating Stripe payment for user bdd85946-e2c5-4b00-9cd3-460f7504537c, subscription tier ID: 43bb8432-68e5-4024-94da-f94b88f63560
2025-01-27 10:19:33,168 [ERROR] [backend.api.payments.payment_service] Error creating Stripe session: 'dict' object has no attribute 'id'
2025-01-27 10:19:33,206 [INFO] [backend.api.payments.payment_service] Processing refund for payment ID: b7afde75-6920-4469-89f3-bd01769d7d64
2025-01-27 10:19:33,209 [INFO] [backend.api.payments.payment_service] Payment refunded successfully: b7afde75-6920-4469-89f3-bd01769d7d64
2025-01-27 10:19:33,215 [INFO] [backend.api.payments.payment_service] Fetching payment history for user ID: ac06cea3-15e5-4deb-9a30-2d9cf271d21d
2025-01-27 10:19:33,237 [INFO] [backend.services.session_service] Creating or fetching session for user_id: bd16acc5-dd89-4e48-bef1-7cb8a2ebf940, is_mobile: False
2025-01-27 10:19:33,239 [DEBUG] [backend.services.session_service] Generated session token: 7a9ebbbc-b7a8-4a01-9423-6ca8f46d8558
2025-01-27 10:19:33,240 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:19:33.240442
2025-01-27 10:19:33,242 [INFO] [backend.services.session_service] New session created for user_id: bd16acc5-dd89-4e48-bef1-7cb8a2ebf940, session_id: 1d18a7e5-d29a-4100-8cf2-a934c93bca22
2025-01-27 10:19:33,251 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 88ddfcad-2e11-41e3-8b3f-7841b620510e, is_mobile: False
2025-01-27 10:19:33,253 [DEBUG] [backend.services.session_service] Generated session token: 48278272-318d-4b6c-a80d-5aefeeacc13e
2025-01-27 10:19:33,253 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:19:33.253040
2025-01-27 10:19:33,254 [INFO] [backend.services.session_service] New session created for user_id: 88ddfcad-2e11-41e3-8b3f-7841b620510e, session_id: f27f04ec-77c1-4242-821c-e03f3ed4e5fe
2025-01-27 10:19:33,263 [INFO] [backend.services.session_service] Creating or fetching session for user_id: f3d19ed9-d880-4210-ab1f-017aac24d443, is_mobile: False
2025-01-27 10:19:33,263 [DEBUG] [backend.services.session_service] Generated session token: 6f82d60a-f4e1-46b0-acc8-37661dc8e179
2025-01-27 10:19:33,263 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:19:33.263435
2025-01-27 10:19:33,263 [INFO] [backend.services.session_service] New session created for user_id: f3d19ed9-d880-4210-ab1f-017aac24d443, session_id: 128ba7b4-c117-496b-be8d-e46a20990d89
2025-01-27 10:19:33,272 [INFO] [backend.services.session_service] Creating or fetching session for user_id: d907f1ca-3c63-40f4-b6ad-f44b9a43678e, is_mobile: False
2025-01-27 10:19:33,272 [DEBUG] [backend.services.session_service] Generated session token: 850c4745-5ee2-482f-ac79-5104e314ed00
2025-01-27 10:19:33,272 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:19:33.272495
2025-01-27 10:19:33,276 [INFO] [backend.services.session_service] New session created for user_id: d907f1ca-3c63-40f4-b6ad-f44b9a43678e, session_id: 0cc034fa-f754-4738-93a5-e8e7bbda1131
2025-01-27 10:19:33,277 [INFO] [backend.services.session_service] Creating or fetching session for user_id: d907f1ca-3c63-40f4-b6ad-f44b9a43678e, is_mobile: True
2025-01-27 10:19:33,278 [DEBUG] [backend.services.session_service] Generated session token: 0430d48a-5648-4666-a9a7-41972671bcda
2025-01-27 10:19:33,278 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 17:19:33.278026
2025-01-27 10:19:33,278 [INFO] [backend.services.session_service] New session created for user_id: d907f1ca-3c63-40f4-b6ad-f44b9a43678e, session_id: be4849ec-6bb3-4db7-beaf-9216f1f73c0c
2025-01-27 10:19:33,278 [INFO] [backend.services.session_service] Invalidating sessions for user_id: d907f1ca-3c63-40f4-b6ad-f44b9a43678e, is_mobile: None
2025-01-27 10:19:33,281 [INFO] [backend.services.session_service] Invalidated 2 session(s) for user_id: d907f1ca-3c63-40f4-b6ad-f44b9a43678e
2025-01-27 10:19:33,284 [INFO] [backend.services.session_service] Creating or fetching session for user_id: cccd587a-dd89-4c7f-9db8-7e38d6e57574, is_mobile: False
2025-01-27 10:19:33,287 [DEBUG] [backend.services.session_service] Generated session token: 063b14e5-d3d2-4ad3-8a0b-9ab4229db4e9
2025-01-27 10:19:33,287 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:19:33.287160
2025-01-27 10:19:33,287 [INFO] [backend.services.session_service] New session created for user_id: cccd587a-dd89-4c7f-9db8-7e38d6e57574, session_id: f925aa6e-1e1b-4aa2-be76-21fb12932a62
2025-01-27 10:19:33,287 [INFO] [backend.services.session_service] Creating or fetching session for user_id: cccd587a-dd89-4c7f-9db8-7e38d6e57574, is_mobile: True
2025-01-27 10:19:33,287 [DEBUG] [backend.services.session_service] Generated session token: 4df5840e-9bdb-4bda-9c62-6b9bac19dc7a
2025-01-27 10:19:33,287 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 17:19:33.287160
2025-01-27 10:19:33,290 [INFO] [backend.services.session_service] New session created for user_id: cccd587a-dd89-4c7f-9db8-7e38d6e57574, session_id: be4e36e4-314c-4a97-964a-73adcd965145
2025-01-27 10:19:33,290 [DEBUG] [backend.services.session_service] Fetching active sessions for user_id: cccd587a-dd89-4c7f-9db8-7e38d6e57574, is_mobile: None
2025-01-27 10:19:33,290 [INFO] [backend.services.session_service] Retrieved 2 active session(s) for user_id: cccd587a-dd89-4c7f-9db8-7e38d6e57574
2025-01-27 10:19:33,296 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 6ef44207-d365-429c-a84a-c52b3d7ea67a, is_mobile: False
2025-01-27 10:19:33,296 [DEBUG] [backend.services.session_service] Generated session token: 3cda05a0-5623-45f6-abf2-ff35403fe9c9
2025-01-27 10:19:33,296 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:19:33.296407
2025-01-27 10:19:33,297 [INFO] [backend.services.session_service] New session created for user_id: 6ef44207-d365-429c-a84a-c52b3d7ea67a, session_id: 7f767c2a-680a-4253-a3f7-4a7d317a4344
2025-01-27 10:19:33,297 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 6ef44207-d365-429c-a84a-c52b3d7ea67a, is_mobile: True
2025-01-27 10:19:33,299 [DEBUG] [backend.services.session_service] Generated session token: b73c05f1-3da9-45d1-af2e-f336241c7a64
2025-01-27 10:19:33,299 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 17:19:33.299701
2025-01-27 10:19:33,299 [INFO] [backend.services.session_service] New session created for user_id: 6ef44207-d365-429c-a84a-c52b3d7ea67a, session_id: d34a66ca-73be-43a2-ad51-7268d45733fe
2025-01-27 10:19:33,299 [INFO] [backend.services.session_service] Fetching active sessions for user_id: 6ef44207-d365-429c-a84a-c52b3d7ea67a
2025-01-27 10:19:33,299 [INFO] [backend.services.session_service] Fetched 2 session(s) for user_id: 6ef44207-d365-429c-a84a-c52b3d7ea67a
2025-01-27 10:19:33,307 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,307 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:19:33,307 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:19:33,308 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,308 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,315 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,318 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:19:33,318 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:19:33,318 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,318 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,327 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,327 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/reset-mfa
2025-01-27 10:19:33,327 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/reset-mfa
2025-01-27 10:19:33,327 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,330 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/reset-mfa "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,337 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,337 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:19:33,337 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:19:33,337 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,339 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,345 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,348 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:19:33,348 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:19:33,348 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,348 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,357 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,357 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:19:33,357 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:19:33,357 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,357 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,367 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,367 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/sessions
2025-01-27 10:19:33,367 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/sessions
2025-01-27 10:19:33,367 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,370 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/sessions "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,376 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,379 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:19:33,379 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:19:33,379 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-27 10:19:33,379 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:19:33,379 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/
2025-01-27 10:19:33,379 [INFO] [backend.api.subscriptions.subscription_routes] Listing subscription tiers.
2025-01-27 10:19:33,385 [DEBUG] [backend.api.subscriptions.subscription_service] Fetched subscription tiers: [<backend.models.subscription_tier.SubscriptionTier object at 0x0000028822DAE870>, <backend.models.subscription_tier.SubscriptionTier object at 0x0000028822DAE9C0>, <backend.models.subscription_tier.SubscriptionTier object at 0x0000028822DAE150>]
2025-01-27 10:19:33,385 [INFO] [backend.main] Response status: 200
2025-01-27 10:19:33,388 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/ "HTTP/1.1 200 OK"
2025-01-27 10:19:33,397 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,397 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/1feb3925-017f-405d-9417-d0baf5d82693
2025-01-27 10:19:33,397 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/1feb3925-017f-405d-9417-d0baf5d82693
2025-01-27 10:19:33,397 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/1feb3925-017f-405d-9417-d0baf5d82693
2025-01-27 10:19:33,397 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/1feb3925-017f-405d-9417-d0baf5d82693
2025-01-27 10:19:33,397 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/1feb3925-017f-405d-9417-d0baf5d82693
2025-01-27 10:19:33,401 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: 1feb3925-017f-405d-9417-d0baf5d82693
2025-01-27 10:19:33,401 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier 1feb3925-017f-405d-9417-d0baf5d82693: 404: Subscription tier not found.
2025-01-27 10:19:33,404 [INFO] [backend.main] Response status: 500
2025-01-27 10:19:33,404 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/1feb3925-017f-405d-9417-d0baf5d82693 "HTTP/1.1 500 Internal Server Error"
2025-01-27 10:19:33,410 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,413 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:19:33,413 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:19:33,413 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-27 10:19:33,413 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:19:33,413 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-27 10:19:33,419 [INFO] [backend.main] Response status: 422
2025-01-27 10:19:33,422 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:19:33,428 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,431 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/0d577a46-ca02-4d41-9547-3766ffb8264b
2025-01-27 10:19:33,431 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/0d577a46-ca02-4d41-9547-3766ffb8264b
2025-01-27 10:19:33,431 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/0d577a46-ca02-4d41-9547-3766ffb8264b
2025-01-27 10:19:33,431 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/0d577a46-ca02-4d41-9547-3766ffb8264b
2025-01-27 10:19:33,431 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/0d577a46-ca02-4d41-9547-3766ffb8264b
2025-01-27 10:19:33,434 [INFO] [backend.main] Response status: 422
2025-01-27 10:19:33,434 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/0d577a46-ca02-4d41-9547-3766ffb8264b "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:19:33,445 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,447 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/c97006a5-2095-489d-a7f1-1094c24f6f3a
2025-01-27 10:19:33,447 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/c97006a5-2095-489d-a7f1-1094c24f6f3a
2025-01-27 10:19:33,447 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/c97006a5-2095-489d-a7f1-1094c24f6f3a
2025-01-27 10:19:33,447 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/c97006a5-2095-489d-a7f1-1094c24f6f3a
2025-01-27 10:19:33,447 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/c97006a5-2095-489d-a7f1-1094c24f6f3a
2025-01-27 10:19:33,448 [INFO] [backend.main] Response status: 422
2025-01-27 10:19:33,450 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/c97006a5-2095-489d-a7f1-1094c24f6f3a "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:19:33,459 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,461 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/a719b91c-f3b6-4f09-9b04-2424a0aede2f/deactivate
2025-01-27 10:19:33,461 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/a719b91c-f3b6-4f09-9b04-2424a0aede2f/deactivate
2025-01-27 10:19:33,462 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/a719b91c-f3b6-4f09-9b04-2424a0aede2f/deactivate
2025-01-27 10:19:33,462 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/a719b91c-f3b6-4f09-9b04-2424a0aede2f/deactivate
2025-01-27 10:19:33,462 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/a719b91c-f3b6-4f09-9b04-2424a0aede2f/deactivate
2025-01-27 10:19:33,462 [INFO] [backend.main] Response status: 422
2025-01-27 10:19:33,465 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/a719b91c-f3b6-4f09-9b04-2424a0aede2f/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:19:33,475 [INFO] [backend.api.subscriptions.subscription_service] Fetching subscription details for user ID fb044cd2-e567-4165-8e79-f0a5eb6fce47
2025-01-27 10:19:33,478 [WARNING] [backend.api.subscriptions.subscription_service] Subscription tier not found for user ID fb044cd2-e567-4165-8e79-f0a5eb6fce47
2025-01-27 10:19:33,491 [INFO] [backend.api.subscriptions.subscription_service] Updating subscription for user ID aaa5d4a3-6214-4a5c-9847-1bb718263528
2025-01-27 10:19:33,509 [INFO] [backend.api.subscriptions.subscription_service] Cancelling subscription for user ID 7a273668-79f6-475b-91f5-65bf6efb271a
2025-01-27 10:19:33,524 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,527 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-27 10:19:33,527 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-27 10:19:33,527 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,527 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,537 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,537 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-27 10:19:33,537 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-27 10:19:33,537 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,537 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,546 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,546 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-27 10:19:33,546 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-27 10:19:33,546 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,549 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,555 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,558 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-27 10:19:33,558 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-27 10:19:33,558 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,558 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,571 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,571 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-27 10:19:33,571 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-27 10:19:33,571 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,574 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=f994a83d-f9aa-446e-9ada-ea20e04b50e9 "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,582 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:19:33,582 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-27 10:19:33,582 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-27 10:19:33,582 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:19:33,585 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-27 10:19:33,788 [INFO] [backend.api.auth.auth_service] User created: ID=def841f0-278b-45a3-88a6-bf588dc28cc5, username=testuser
2025-01-27 10:19:33,982 [INFO] [backend.api.auth.auth_service] User created: ID=3b278c06-e9a0-4e06-b445-d8fe3ab6d93e, username=testuser
2025-01-27 10:19:34,180 [INFO] [backend.api.auth.auth_service] User created: ID=794a29d4-5bec-4cca-895e-b4543cc97e4c, username=testuser
2025-01-27 10:19:34,565 [INFO] [backend.api.auth.auth_service] User created: ID=1f520cd4-84c7-4fad-9ed4-47fd8fb56523, username=testuser
2025-01-27 10:19:34,752 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-27 10:19:34,951 [INFO] [backend.api.auth.auth_service] User created: ID=1deffba8-2b11-4694-abbd-48116522629d, username=testuser
2025-01-27 10:19:34,951 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-27 10:19:35,157 [INFO] [backend.api.auth.auth_service] User created: ID=863fcb1a-a2f7-4c9b-ae7a-b2385d95af97, username=testuser
2025-01-27 10:19:35,348 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-27 10:50:18,532 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-27 10:50:18,535 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-27 10:50:18,535 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-27 10:50:18,544 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-27 10:50:19,098 [INFO] [backend.main] Session validation middleware added.
2025-01-27 10:50:19,098 [INFO] [backend.main] MFA validation middleware added.
2025-01-27 10:50:19,098 [INFO] [backend.main] Admin validation middleware added.
2025-01-27 10:50:19,098 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-27 10:50:19,098 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-27 10:50:19,101 [INFO] [backend.main] Auth router registered.
2025-01-27 10:50:19,107 [INFO] [backend.main] User router registered.
2025-01-27 10:50:19,110 [INFO] [backend.main] Workout router registered.
2025-01-27 10:50:19,116 [INFO] [backend.main] Payment router registered.
2025-01-27 10:50:19,122 [INFO] [backend.main] Subscription router registered.
2025-01-27 10:50:19,122 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-27 10:50:19,125 [INFO] [backend.main] Admin router registered.
2025-01-27 10:50:19,463 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:19,466 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-27 10:50:19,466 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-27 10:50:19,466 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-27 10:50:19,785 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:19,785 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/login
2025-01-27 10:50:19,785 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/login
2025-01-27 10:50:19,785 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/login
2025-01-27 10:50:19,785 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/login
2025-01-27 10:50:19,788 [INFO] [backend.main] Processing request POST http://testserver/api/admin/login
2025-01-27 10:50:19,791 [DEBUG] [backend.api.admin.admin_routes] Attempting to log in admin: admin@example.com
2025-01-27 10:50:19,952 [WARNING] [backend.api.admin.admin_routes] Invalid login attempt for email: admin@example.com
2025-01-27 10:50:19,952 [ERROR] [backend.api.admin.admin_routes] Unexpected error during login: 401: Invalid email or password
2025-01-27 10:50:19,952 [INFO] [backend.main] Response status: 500
2025-01-27 10:50:19,955 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/login "HTTP/1.1 500 Internal Server Error"
2025-01-27 10:50:19,964 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:19,967 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 10:50:19,967 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 10:50:19,967 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/setup
2025-01-27 10:50:19,967 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/setup
2025-01-27 10:50:19,967 [INFO] [backend.main] Processing request GET http://testserver/api/admin/mfa/setup?user_id=c602d75c-bd4b-4529-8f7f-7dfdd2075247
2025-01-27 10:50:19,974 [INFO] [backend.main] Response status: 403
2025-01-27 10:50:19,974 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/mfa/setup?user_id=c602d75c-bd4b-4529-8f7f-7dfdd2075247 "HTTP/1.1 403 Forbidden"
2025-01-27 10:50:19,983 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:19,985 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 10:50:19,985 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 10:50:19,985 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/verify
2025-01-27 10:50:19,985 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/verify
2025-01-27 10:50:19,986 [INFO] [backend.main] Processing request POST http://testserver/api/admin/mfa/verify
2025-01-27 10:50:19,986 [DEBUG] [backend.api.admin.admin_routes] User MFA verify: user_id=8915e36a-f8f9-4306-87e3-6e1f059ced49, totp_code=123456
2025-01-27 10:50:19,988 [DEBUG] [backend.services.session_service] Validating session token: test-session-token
2025-01-27 10:50:19,989 [WARNING] [backend.services.session_service] Session token not found: test-session-token
2025-01-27 10:50:19,989 [ERROR] [backend.api.admin.admin_routes] MFA verification error: 401: Session not found
2025-01-27 10:50:19,989 [INFO] [backend.main] Response status: 401
2025-01-27 10:50:19,992 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/mfa/verify "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:19,999 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,002 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/list
2025-01-27 10:50:20,002 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-27 10:50:20,002 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/list "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:20,008 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,010 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-27 10:50:20,010 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-27 10:50:20,011 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:20,017 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 10:50:20,017 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-27 10:50:20,019 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-27 10:50:20,019 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-27 10:50:20,235 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: e821bef8-6d6c-464c-9957-fb9274b666ee)
2025-01-27 10:50:20,239 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 10:50:20,433 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 25e72fca-48ec-407b-8e77-fb53bbab5090)
2025-01-27 10:50:20,433 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-27 10:50:20,626 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: 703243d1-8423-433d-b7d4-b9e596da4549)
2025-01-27 10:50:20,629 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-27 10:50:20,636 [INFO] [backend.api.admin.admin_service] Retrieved 1 flagged users
2025-01-27 10:50:20,640 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,642 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-27 10:50:20,642 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-27 10:50:20,642 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-27 10:50:20,642 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-27 10:50:20,642 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-27 10:50:20,651 [ERROR] [backend.api.auth.auth_routes] Registration failed: Username already registered
2025-01-27 10:50:20,655 [INFO] [backend.main] Response status: 400
2025-01-27 10:50:20,655 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
2025-01-27 10:50:20,666 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,666 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/login
2025-01-27 10:50:20,668 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/login
2025-01-27 10:50:20,668 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/login
2025-01-27 10:50:20,668 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/login
2025-01-27 10:50:20,668 [INFO] [backend.main] Processing request POST http://testserver/api/auth/login
2025-01-27 10:50:20,668 [INFO] [backend.api.auth.auth_routes] Login attempt for email: testuser@example.com, is_mobile: False
2025-01-27 10:50:20,671 [WARNING] [backend.api.auth.auth_routes] User with email testuser@example.com not found
2025-01-27 10:50:20,671 [INFO] [backend.main] Response status: 401
2025-01-27 10:50:20,671 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:20,680 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,684 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/verify-email
2025-01-27 10:50:20,684 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/verify-email
2025-01-27 10:50:20,684 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/verify-email
2025-01-27 10:50:20,684 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/verify-email
2025-01-27 10:50:20,684 [INFO] [backend.main] Processing request GET http://testserver/api/auth/verify-email?token=fake-token
2025-01-27 10:50:20,686 [ERROR] [backend.api.auth.auth_routes] Error during email verification
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\backend\api\auth\auth_routes.py", line 184, in verify_email
    raise HTTPException(status_code=404, detail="User not found")
fastapi.exceptions.HTTPException: 404: User not found
2025-01-27 10:50:20,688 [INFO] [backend.main] Response status: 307
2025-01-27 10:50:20,690 [INFO] [httpx] HTTP Request: GET http://testserver/api/auth/verify-email?token=fake-token "HTTP/1.1 307 Temporary Redirect"
2025-01-27 10:50:20,690 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,693 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /verify-email
2025-01-27 10:50:20,695 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /verify-email
2025-01-27 10:50:20,695 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:20,696 [INFO] [httpx] HTTP Request: GET http://localhost:3000/verify-email?status=error "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:20,706 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,707 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 10:50:20,708 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 10:50:20,708 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/resend-verification
2025-01-27 10:50:20,708 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/resend-verification
2025-01-27 10:50:20,708 [INFO] [backend.main] Processing request POST http://testserver/api/auth/resend-verification
2025-01-27 10:50:20,708 [INFO] [backend.main] Response status: 422
2025-01-27 10:50:20,711 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/resend-verification "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:50:20,717 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,721 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout
2025-01-27 10:50:20,721 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout
2025-01-27 10:50:20,721 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout
2025-01-27 10:50:20,721 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout
2025-01-27 10:50:20,723 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout
2025-01-27 10:50:20,724 [INFO] [backend.main] Response status: 403
2025-01-27 10:50:20,724 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
2025-01-27 10:50:20,733 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:20,734 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout-all
2025-01-27 10:50:20,734 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout-all
2025-01-27 10:50:20,734 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout-all
2025-01-27 10:50:20,734 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout-all
2025-01-27 10:50:20,734 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout-all
2025-01-27 10:50:20,734 [INFO] [backend.main] Response status: 422
2025-01-27 10:50:20,737 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout-all "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:50:20,948 [INFO] [backend.api.auth.auth_service] User created: ID=72a103fa-cc47-4175-8823-3b825d4b17ef, username=testuser
2025-01-27 10:50:21,726 [INFO] [backend.api.auth.auth_service] User created: ID=69d6283b-8d4a-431b-a61a-1457012d871d, username=testuser
2025-01-27 10:50:21,918 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-27 10:50:22,122 [INFO] [backend.api.auth.auth_service] User created: ID=d4f7bb1a-bee2-4d6f-ac5b-516d14c139b4, username=testuser
2025-01-27 10:50:22,321 [INFO] [backend.api.auth.auth_service] User created: ID=a34714d6-d9c9-41f1-bdac-490a6c5be323, username=testuser
2025-01-27 10:50:22,323 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-27 10:50:22,527 [INFO] [backend.api.auth.auth_service] User created: ID=c4c41e42-8c20-4cf8-8dd9-fb5c7986e66c, username=testuser
2025-01-27 10:50:22,723 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-27 10:50:22,726 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-27 10:50:22,760 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-27 10:50:22,760 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-27 10:50:22,766 [INFO] [backend.services.mfa] Resetting MFA for user_id: 611ce044-47ea-43a8-b745-21b1d60f7d82
2025-01-27 10:50:22,773 [INFO] [backend.services.mfa] MFA reset successfully for user_id: 611ce044-47ea-43a8-b745-21b1d60f7d82
2025-01-27 10:50:22,776 [INFO] [backend.services.mfa] Resetting MFA for user_id: 6bc53924-8799-4fd0-a208-71888a506e43
2025-01-27 10:50:22,776 [ERROR] [backend.services.mfa] User not found for MFA reset: 6bc53924-8799-4fd0-a208-71888a506e43
2025-01-27 10:50:22,785 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:22,788 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/create
2025-01-27 10:50:22,788 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/create
2025-01-27 10:50:22,788 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/create
2025-01-27 10:50:22,788 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/create
2025-01-27 10:50:22,789 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 10:50:22,789 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/create?subscription_tier=900fa543-906f-4c6d-b2a4-6d39de4b1633 "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:22,810 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:22,810 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/verify
2025-01-27 10:50:22,812 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/verify
2025-01-27 10:50:22,812 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/verify
2025-01-27 10:50:22,812 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/verify
2025-01-27 10:50:22,812 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 10:50:22,812 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/verify?session_id=stripe-session-id "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:22,823 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:22,826 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/refund
2025-01-27 10:50:22,826 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/refund
2025-01-27 10:50:22,826 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:22,826 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/refund?payment_id=020af225-ccb1-41f2-880b-cde32619821c "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:22,835 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:22,838 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/history
2025-01-27 10:50:22,838 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/history
2025-01-27 10:50:22,838 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:22,840 [INFO] [httpx] HTTP Request: GET http://testserver/api/payments/history?page=1&page_size=10 "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:22,847 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:22,847 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/payments/create
2025-01-27 10:50:22,847 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/payments/create
2025-01-27 10:50:22,847 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/payments/create
2025-01-27 10:50:22,847 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/payments/create
2025-01-27 10:50:22,847 [DEBUG] [backend.api.middlewares.session_middleware] Authorization Header: None
2025-01-27 10:50:22,851 [INFO] [httpx] HTTP Request: POST http://testserver/api/payments/create?subscription_tier=invalid-tier-id "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:22,860 [INFO] [backend.api.payments.payment_service] Creating Stripe payment for user 1f30ffe1-9663-4be8-828b-f296065f1abf, subscription tier ID: 5a018579-f06a-4c4c-af92-385d00460491
2025-01-27 10:50:22,863 [ERROR] [backend.api.payments.payment_service] Error creating Stripe session: 'dict' object has no attribute 'id'
2025-01-27 10:50:22,900 [INFO] [backend.api.payments.payment_service] Processing refund for payment ID: efd55be1-844d-4c3c-b4bd-69eab1214186
2025-01-27 10:50:22,904 [INFO] [backend.api.payments.payment_service] Payment refunded successfully: efd55be1-844d-4c3c-b4bd-69eab1214186
2025-01-27 10:50:22,913 [INFO] [backend.api.payments.payment_service] Fetching payment history for user ID: 0478e246-0e42-4304-ba86-7a33cc023c95
2025-01-27 10:50:22,932 [INFO] [backend.services.session_service] Creating or fetching session for user_id: de0c2825-d544-4a49-85c8-5f66b481772b, is_mobile: False
2025-01-27 10:50:22,935 [DEBUG] [backend.services.session_service] Generated session token: 11dd7e8f-6a22-4d39-86e7-1548ea49c351
2025-01-27 10:50:22,935 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:50:22.935270
2025-01-27 10:50:22,938 [INFO] [backend.services.session_service] New session created for user_id: de0c2825-d544-4a49-85c8-5f66b481772b, session_id: ba8b7709-e595-404c-9368-750292b5017c
2025-01-27 10:50:22,947 [INFO] [backend.services.session_service] Creating or fetching session for user_id: fc70afd3-2fc0-4b87-ab1b-21f612557edb, is_mobile: False
2025-01-27 10:50:22,947 [DEBUG] [backend.services.session_service] Generated session token: c97e72d6-5b86-45d5-b9e1-3ea146f1a776
2025-01-27 10:50:22,950 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:50:22.950887
2025-01-27 10:50:22,950 [INFO] [backend.services.session_service] New session created for user_id: fc70afd3-2fc0-4b87-ab1b-21f612557edb, session_id: eebf36a9-80d6-428f-8b6f-8c1d0beb89c1
2025-01-27 10:50:22,957 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 4ff5e3a2-f07f-4353-8642-d768631e55fa, is_mobile: False
2025-01-27 10:50:22,960 [DEBUG] [backend.services.session_service] Generated session token: 66a8e7d0-0fd8-4ebf-9731-abbd0c220831
2025-01-27 10:50:22,960 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:50:22.960701
2025-01-27 10:50:22,960 [INFO] [backend.services.session_service] New session created for user_id: 4ff5e3a2-f07f-4353-8642-d768631e55fa, session_id: e225e633-8729-4e1e-b55d-73a73a7a7ae5
2025-01-27 10:50:22,970 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 8acc829f-194c-4cab-94d5-fec58acb7759, is_mobile: False
2025-01-27 10:50:22,970 [DEBUG] [backend.services.session_service] Generated session token: 8ddbc6da-36ad-41fb-ae97-a8ab3f602983
2025-01-27 10:50:22,970 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:50:22.970014
2025-01-27 10:50:22,973 [INFO] [backend.services.session_service] New session created for user_id: 8acc829f-194c-4cab-94d5-fec58acb7759, session_id: 260e4a88-3a18-4805-b776-fdad271a3aa5
2025-01-27 10:50:22,973 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 8acc829f-194c-4cab-94d5-fec58acb7759, is_mobile: True
2025-01-27 10:50:22,973 [DEBUG] [backend.services.session_service] Generated session token: 15a95023-4476-4e98-9945-ce5297384752
2025-01-27 10:50:22,973 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 17:50:22.973438
2025-01-27 10:50:22,973 [INFO] [backend.services.session_service] New session created for user_id: 8acc829f-194c-4cab-94d5-fec58acb7759, session_id: d298655c-0cd9-4f7d-a7be-df41822634c0
2025-01-27 10:50:22,976 [INFO] [backend.services.session_service] Invalidating sessions for user_id: 8acc829f-194c-4cab-94d5-fec58acb7759, is_mobile: None
2025-01-27 10:50:22,976 [INFO] [backend.services.session_service] Invalidated 2 session(s) for user_id: 8acc829f-194c-4cab-94d5-fec58acb7759
2025-01-27 10:50:22,982 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 2867d915-bb16-427c-8cdc-2990e258f1d2, is_mobile: False
2025-01-27 10:50:22,982 [DEBUG] [backend.services.session_service] Generated session token: 11bdbd78-9eca-445f-9797-722ae707cc78
2025-01-27 10:50:22,982 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:50:22.982604
2025-01-27 10:50:22,985 [INFO] [backend.services.session_service] New session created for user_id: 2867d915-bb16-427c-8cdc-2990e258f1d2, session_id: 265ef59f-f263-4b1e-874f-f8499896261e
2025-01-27 10:50:22,985 [INFO] [backend.services.session_service] Creating or fetching session for user_id: 2867d915-bb16-427c-8cdc-2990e258f1d2, is_mobile: True
2025-01-27 10:50:22,985 [DEBUG] [backend.services.session_service] Generated session token: 13c8491e-cae8-42fa-8e70-4dbb59f376e1
2025-01-27 10:50:22,985 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 17:50:22.985617
2025-01-27 10:50:22,989 [INFO] [backend.services.session_service] New session created for user_id: 2867d915-bb16-427c-8cdc-2990e258f1d2, session_id: 241b4bcf-d568-407a-b928-03dd4e114dfc
2025-01-27 10:50:22,989 [DEBUG] [backend.services.session_service] Fetching active sessions for user_id: 2867d915-bb16-427c-8cdc-2990e258f1d2, is_mobile: None
2025-01-27 10:50:22,989 [INFO] [backend.services.session_service] Retrieved 2 active session(s) for user_id: 2867d915-bb16-427c-8cdc-2990e258f1d2
2025-01-27 10:50:22,992 [INFO] [backend.services.session_service] Creating or fetching session for user_id: ea937598-0d1b-4b73-8c2f-38c47390557c, is_mobile: False
2025-01-27 10:50:22,995 [DEBUG] [backend.services.session_service] Generated session token: e6f32a26-f723-4867-a783-c42e57b3dd17
2025-01-27 10:50:22,995 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2025-02-03 17:50:22.995611
2025-01-27 10:50:22,996 [INFO] [backend.services.session_service] New session created for user_id: ea937598-0d1b-4b73-8c2f-38c47390557c, session_id: 9f7f1700-a22e-40e5-8782-491c94219b76
2025-01-27 10:50:22,996 [INFO] [backend.services.session_service] Creating or fetching session for user_id: ea937598-0d1b-4b73-8c2f-38c47390557c, is_mobile: True
2025-01-27 10:50:22,998 [DEBUG] [backend.services.session_service] Generated session token: 31d655fd-af1f-46f0-a2d4-2ff75e9a3ba7
2025-01-27 10:50:22,998 [DEBUG] [backend.services.session_service] Creating new session with expiry: 2026-01-27 17:50:22.998772
2025-01-27 10:50:22,998 [INFO] [backend.services.session_service] New session created for user_id: ea937598-0d1b-4b73-8c2f-38c47390557c, session_id: 0bfd378a-bef0-4fb5-bae7-319bdc1fe252
2025-01-27 10:50:22,998 [INFO] [backend.services.session_service] Fetching active sessions for user_id: ea937598-0d1b-4b73-8c2f-38c47390557c
2025-01-27 10:50:22,998 [INFO] [backend.services.session_service] Fetched 2 session(s) for user_id: ea937598-0d1b-4b73-8c2f-38c47390557c
2025-01-27 10:50:23,004 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,004 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:50:23,004 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:50:23,004 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,004 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,014 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,014 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:50:23,017 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-27 10:50:23,017 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,017 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,024 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,027 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/reset-mfa
2025-01-27 10:50:23,027 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/reset-mfa
2025-01-27 10:50:23,027 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,027 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/reset-mfa "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,036 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,036 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:50:23,036 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:50:23,039 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,039 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,048 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,048 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:50:23,048 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:50:23,048 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,048 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,058 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,060 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:50:23,060 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-27 10:50:23,060 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,060 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,069 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,069 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/sessions
2025-01-27 10:50:23,069 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/sessions
2025-01-27 10:50:23,069 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,073 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/sessions "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,079 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,079 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:50:23,079 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:50:23,082 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-27 10:50:23,082 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:50:23,082 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/
2025-01-27 10:50:23,082 [INFO] [backend.api.subscriptions.subscription_routes] Listing subscription tiers.
2025-01-27 10:50:23,085 [DEBUG] [backend.api.subscriptions.subscription_service] Fetched subscription tiers: [<backend.models.subscription_tier.SubscriptionTier object at 0x0000023A21BB16A0>, <backend.models.subscription_tier.SubscriptionTier object at 0x0000023A21BB1640>, <backend.models.subscription_tier.SubscriptionTier object at 0x0000023A21BB1610>]
2025-01-27 10:50:23,088 [INFO] [backend.main] Response status: 200
2025-01-27 10:50:23,088 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/ "HTTP/1.1 200 OK"
2025-01-27 10:50:23,098 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,101 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/3951f3cf-ad8d-4c01-8f12-bbbf18e0058f
2025-01-27 10:50:23,101 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/3951f3cf-ad8d-4c01-8f12-bbbf18e0058f
2025-01-27 10:50:23,101 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/3951f3cf-ad8d-4c01-8f12-bbbf18e0058f
2025-01-27 10:50:23,101 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/3951f3cf-ad8d-4c01-8f12-bbbf18e0058f
2025-01-27 10:50:23,102 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/3951f3cf-ad8d-4c01-8f12-bbbf18e0058f
2025-01-27 10:50:23,102 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: 3951f3cf-ad8d-4c01-8f12-bbbf18e0058f
2025-01-27 10:50:23,104 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier 3951f3cf-ad8d-4c01-8f12-bbbf18e0058f: 404: Subscription tier not found.
2025-01-27 10:50:23,106 [INFO] [backend.main] Response status: 500
2025-01-27 10:50:23,107 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/3951f3cf-ad8d-4c01-8f12-bbbf18e0058f "HTTP/1.1 500 Internal Server Error"
2025-01-27 10:50:23,113 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,113 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:50:23,113 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:50:23,113 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-27 10:50:23,113 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-27 10:50:23,116 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-27 10:50:23,232 [INFO] [backend.main] Response status: 422
2025-01-27 10:50:23,234 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:50:23,241 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,244 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/fb693d5f-444b-49c3-ad3a-47a90c7c1d53
2025-01-27 10:50:23,244 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/fb693d5f-444b-49c3-ad3a-47a90c7c1d53
2025-01-27 10:50:23,244 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/fb693d5f-444b-49c3-ad3a-47a90c7c1d53
2025-01-27 10:50:23,244 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/fb693d5f-444b-49c3-ad3a-47a90c7c1d53
2025-01-27 10:50:23,246 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/fb693d5f-444b-49c3-ad3a-47a90c7c1d53
2025-01-27 10:50:23,248 [INFO] [backend.main] Response status: 422
2025-01-27 10:50:23,248 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/fb693d5f-444b-49c3-ad3a-47a90c7c1d53 "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:50:23,258 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,261 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/6b86cc14-a93e-4c7a-9c68-34399168bd2c
2025-01-27 10:50:23,261 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/6b86cc14-a93e-4c7a-9c68-34399168bd2c
2025-01-27 10:50:23,261 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/6b86cc14-a93e-4c7a-9c68-34399168bd2c
2025-01-27 10:50:23,261 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/6b86cc14-a93e-4c7a-9c68-34399168bd2c
2025-01-27 10:50:23,261 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/6b86cc14-a93e-4c7a-9c68-34399168bd2c
2025-01-27 10:50:23,261 [INFO] [backend.main] Response status: 422
2025-01-27 10:50:23,261 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/6b86cc14-a93e-4c7a-9c68-34399168bd2c "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:50:23,271 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,273 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/5d46806b-aaa7-4a29-802b-98274f5883cf/deactivate
2025-01-27 10:50:23,273 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/5d46806b-aaa7-4a29-802b-98274f5883cf/deactivate
2025-01-27 10:50:23,273 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/5d46806b-aaa7-4a29-802b-98274f5883cf/deactivate
2025-01-27 10:50:23,273 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/5d46806b-aaa7-4a29-802b-98274f5883cf/deactivate
2025-01-27 10:50:23,273 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/5d46806b-aaa7-4a29-802b-98274f5883cf/deactivate
2025-01-27 10:50:23,275 [INFO] [backend.main] Response status: 422
2025-01-27 10:50:23,276 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/5d46806b-aaa7-4a29-802b-98274f5883cf/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-27 10:50:23,287 [INFO] [backend.api.subscriptions.subscription_service] Fetching subscription details for user ID 69932c7e-739f-4ddb-880c-3e192f2ffb4e
2025-01-27 10:50:23,288 [WARNING] [backend.api.subscriptions.subscription_service] Subscription tier not found for user ID 69932c7e-739f-4ddb-880c-3e192f2ffb4e
2025-01-27 10:50:23,303 [INFO] [backend.api.subscriptions.subscription_service] Updating subscription for user ID 5cf5657b-a77e-4597-9038-5f9d310fd200
2025-01-27 10:50:23,322 [INFO] [backend.api.subscriptions.subscription_service] Cancelling subscription for user ID 48c3ce48-c6cf-41f9-a1d6-267dd09da504
2025-01-27 10:50:23,338 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,338 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-27 10:50:23,341 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-27 10:50:23,341 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,341 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,348 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,352 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-27 10:50:23,352 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-27 10:50:23,352 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,352 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,361 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,361 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-27 10:50:23,361 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-27 10:50:23,361 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,361 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,370 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,370 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-27 10:50:23,370 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-27 10:50:23,370 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,370 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,383 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,383 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-27 10:50:23,383 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-27 10:50:23,383 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,386 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=9dd5e21f-fab2-47d1-8854-5fd872a7b8c8 "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,392 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-27 10:50:23,396 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-27 10:50:23,396 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-27 10:50:23,396 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-27 10:50:23,396 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-27 10:50:23,598 [INFO] [backend.api.auth.auth_service] User created: ID=3c6dd5cd-9d2b-4aa0-8a81-322ecab2aa24, username=testuser
2025-01-27 10:50:23,795 [INFO] [backend.api.auth.auth_service] User created: ID=e7b49baa-a7f4-4e1b-8715-72e12fe1db32, username=testuser
2025-01-27 10:50:23,990 [INFO] [backend.api.auth.auth_service] User created: ID=ecac4155-2812-4340-b59a-68bf547c85b8, username=testuser
2025-01-27 10:50:24,391 [INFO] [backend.api.auth.auth_service] User created: ID=16d21d67-f5a1-4884-9b90-c96653bf735c, username=testuser
2025-01-27 10:50:24,585 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-27 10:50:24,786 [INFO] [backend.api.auth.auth_service] User created: ID=ee826d6d-0b3e-4d64-9533-c2a24fcaa0a2, username=testuser
2025-01-27 10:50:24,786 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-27 10:50:24,989 [INFO] [backend.api.auth.auth_service] User created: ID=b765d8bb-aaca-4e17-8771-ab0dabae2e71, username=testuser
2025-01-27 10:50:25,183 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-28 11:13:28,057 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-28 11:13:28,058 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-28 11:13:28,058 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-28 11:13:28,082 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 11:13:28,458 [INFO] [backend.main] Session validation middleware added.
2025-01-28 11:13:28,458 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 11:13:28,458 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 11:13:28,458 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 11:13:28,459 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 11:13:28,463 [INFO] [backend.main] Auth router registered.
2025-01-28 11:13:28,469 [INFO] [backend.main] User router registered.
2025-01-28 11:13:28,472 [INFO] [backend.main] Workout router registered.
2025-01-28 11:13:28,480 [INFO] [backend.main] Payment router registered.
2025-01-28 11:13:28,485 [INFO] [backend.main] Subscription router registered.
2025-01-28 11:13:28,485 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 11:13:28,488 [INFO] [backend.main] Admin router registered.
2025-01-28 11:13:28,742 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:28,743 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/create
2025-01-28 11:13:28,744 [WARNING] [backend.api.middlewares.admin_middleware] Unauthorized IP for /create: testclient
2025-01-28 11:13:28,745 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/create "HTTP/1.1 403 Forbidden"
2025-01-28 11:13:29,048 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,051 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/login
2025-01-28 11:13:29,051 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/login
2025-01-28 11:13:29,051 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/login
2025-01-28 11:13:29,051 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/login
2025-01-28 11:13:29,052 [INFO] [backend.main] Processing request POST http://testserver/api/admin/login
2025-01-28 11:13:29,056 [DEBUG] [backend.api.admin.admin_routes] Attempting to log in admin: admin@example.com
2025-01-28 11:13:29,104 [WARNING] [backend.api.admin.admin_routes] Invalid login attempt for email: admin@example.com
2025-01-28 11:13:29,105 [ERROR] [backend.api.admin.admin_routes] Unexpected error during login: 401: Invalid email or password
2025-01-28 11:13:29,106 [INFO] [backend.main] Response status: 500
2025-01-28 11:13:29,107 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/login "HTTP/1.1 500 Internal Server Error"
2025-01-28 11:13:29,116 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,117 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/list
2025-01-28 11:13:29,117 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-28 11:13:29,118 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/list "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:29,124 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,125 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/moderate-flagged
2025-01-28 11:13:29,125 [WARNING] [backend.api.middlewares.admin_middleware] Missing or invalid Authorization header.
2025-01-28 11:13:29,126 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/moderate-flagged "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:29,133 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,135 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/setup
2025-01-28 11:13:29,135 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/setup
2025-01-28 11:13:29,135 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/setup
2025-01-28 11:13:29,135 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/setup
2025-01-28 11:13:29,135 [INFO] [backend.main] Processing request GET http://testserver/api/admin/mfa/setup?user_id=beeb73ee-b881-4bfb-ab95-2e495d989a24
2025-01-28 11:13:29,141 [INFO] [backend.main] Response status: 403
2025-01-28 11:13:29,142 [INFO] [httpx] HTTP Request: GET http://testserver/api/admin/mfa/setup?user_id=beeb73ee-b881-4bfb-ab95-2e495d989a24 "HTTP/1.1 403 Forbidden"
2025-01-28 11:13:29,151 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,152 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/admin/mfa/verify
2025-01-28 11:13:29,152 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/admin/mfa/verify
2025-01-28 11:13:29,153 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/admin/mfa/verify
2025-01-28 11:13:29,153 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/admin/mfa/verify
2025-01-28 11:13:29,153 [INFO] [backend.main] Processing request POST http://testserver/api/admin/mfa/verify
2025-01-28 11:13:29,155 [DEBUG] [backend.api.admin.admin_routes] User MFA verify: user_id=dc0414fd-6023-4843-a333-9d9389440ebc, totp_code=123456
2025-01-28 11:13:29,155 [DEBUG] [backend.services.session_service] Validating session token: mock-session-token
2025-01-28 11:13:29,159 [WARNING] [backend.services.session_service] Session token not found: mock-session-token
2025-01-28 11:13:29,159 [ERROR] [backend.api.admin.admin_routes] MFA verification error: 401: Session not found
2025-01-28 11:13:29,160 [INFO] [backend.main] Response status: 401
2025-01-28 11:13:29,161 [INFO] [httpx] HTTP Request: POST http://testserver/api/admin/mfa/verify "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:29,168 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-28 11:13:29,168 [WARNING] [passlib.handlers.bcrypt] (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\.venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-01-28 11:13:29,169 [DEBUG] [passlib.handlers.bcrypt] detected 'bcrypt' backend, version '<unknown>'
2025-01-28 11:13:29,169 [DEBUG] [passlib.handlers.bcrypt] 'bcrypt' backend lacks $2$ support, enabling workaround
2025-01-28 11:13:29,380 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: dbf77b1c-4f01-4623-b2cb-538d3a5fb8a9)
2025-01-28 11:13:29,383 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser' email='admin@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-28 11:13:29,575 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser (ID: 5f2ee91c-a2f9-47a8-87c6-feffeb976e4b)
2025-01-28 11:13:29,575 [DEBUG] [backend.api.admin.admin_service] Starting admin creation. User data: full_name='Admin User' username='adminuser2' email='admin2@example.com' bio=None profile_picture=None fitness_goals=None hashed_password='hashedpassword' accepted_terms=True accepted_privacy_policy=True admin_secret_key='test_secret_key' subscription_plan='Free' setup_step=<SetupStep.email_verification: 'verify_email'> user_type=<UserType.ADMIN: 'admin'> is_active=True is_verified=False activity_level=None height=None weight=None height_unit='ft/in' weight_unit='lbs' profile_version=1 flagged_for_review=False joined_at=None accepted_terms_at=None accepted_privacy_policy_at=None age=None gender=None email_notifications=True push_notifications=True
2025-01-28 11:13:29,765 [INFO] [backend.api.admin.admin_service] Admin user created: adminuser2 (ID: 777da821-0ceb-4c6f-a23a-f2e349989c19)
2025-01-28 11:13:29,766 [INFO] [backend.api.admin.admin_service] Retrieved 2 admin users
2025-01-28 11:13:29,770 [INFO] [backend.api.admin.admin_service] Retrieved 1 flagged users
2025-01-28 11:13:29,774 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,775 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/register
2025-01-28 11:13:29,775 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/register
2025-01-28 11:13:29,775 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/register
2025-01-28 11:13:29,775 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/register
2025-01-28 11:13:29,776 [INFO] [backend.main] Processing request POST http://testserver/api/auth/register
2025-01-28 11:13:29,785 [ERROR] [backend.api.auth.auth_routes] Registration failed: Username already registered
2025-01-28 11:13:29,786 [INFO] [backend.main] Response status: 400
2025-01-28 11:13:29,786 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
2025-01-28 11:13:29,796 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,798 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/login
2025-01-28 11:13:29,798 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/login
2025-01-28 11:13:29,798 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/login
2025-01-28 11:13:29,799 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/login
2025-01-28 11:13:29,800 [INFO] [backend.main] Processing request POST http://testserver/api/auth/login
2025-01-28 11:13:29,801 [INFO] [backend.api.auth.auth_routes] Login attempt for email: testuser@example.com, is_mobile: False
2025-01-28 11:13:29,803 [WARNING] [backend.api.auth.auth_routes] User with email testuser@example.com not found
2025-01-28 11:13:29,804 [INFO] [backend.main] Response status: 401
2025-01-28 11:13:29,805 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:29,812 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,814 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/verify-email
2025-01-28 11:13:29,814 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/verify-email
2025-01-28 11:13:29,815 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/verify-email
2025-01-28 11:13:29,815 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/verify-email
2025-01-28 11:13:29,815 [INFO] [backend.main] Processing request GET http://testserver/api/auth/verify-email?token=fake-token
2025-01-28 11:13:29,818 [ERROR] [backend.api.auth.auth_routes] Error during email verification
Traceback (most recent call last):
  File "C:\Users\joshu\Documents\python\project-yoked\backend\api\auth\auth_routes.py", line 184, in verify_email
    raise HTTPException(status_code=404, detail="User not found")
fastapi.exceptions.HTTPException: 404: User not found
2025-01-28 11:13:29,819 [INFO] [backend.main] Response status: 307
2025-01-28 11:13:29,820 [INFO] [httpx] HTTP Request: GET http://testserver/api/auth/verify-email?token=fake-token "HTTP/1.1 307 Temporary Redirect"
2025-01-28 11:13:29,821 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,823 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /verify-email
2025-01-28 11:13:29,823 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /verify-email
2025-01-28 11:13:29,823 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:29,824 [INFO] [httpx] HTTP Request: GET http://localhost:3000/verify-email?status=error "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:29,832 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,833 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/resend-verification
2025-01-28 11:13:29,833 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/resend-verification
2025-01-28 11:13:29,833 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/resend-verification
2025-01-28 11:13:29,833 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/resend-verification
2025-01-28 11:13:29,834 [INFO] [backend.main] Processing request POST http://testserver/api/auth/resend-verification
2025-01-28 11:13:29,835 [INFO] [backend.main] Response status: 422
2025-01-28 11:13:29,837 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/resend-verification "HTTP/1.1 422 Unprocessable Entity"
2025-01-28 11:13:29,844 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,845 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout
2025-01-28 11:13:29,845 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout
2025-01-28 11:13:29,845 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout
2025-01-28 11:13:29,845 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout
2025-01-28 11:13:29,847 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout
2025-01-28 11:13:29,848 [INFO] [backend.main] Response status: 403
2025-01-28 11:13:29,849 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
2025-01-28 11:13:29,858 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:29,859 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/auth/logout-all
2025-01-28 11:13:29,859 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/auth/logout-all
2025-01-28 11:13:29,859 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/auth/logout-all
2025-01-28 11:13:29,859 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/auth/logout-all
2025-01-28 11:13:29,860 [INFO] [backend.main] Processing request POST http://testserver/api/auth/logout-all
2025-01-28 11:13:29,861 [INFO] [backend.main] Response status: 422
2025-01-28 11:13:29,862 [INFO] [httpx] HTTP Request: POST http://testserver/api/auth/logout-all "HTTP/1.1 422 Unprocessable Entity"
2025-01-28 11:13:30,079 [INFO] [backend.api.auth.auth_service] User created: ID=95bed72e-67ab-4b2d-8488-20812e0878d9, username=testuser
2025-01-28 11:13:30,086 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-28 11:13:30,089 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-28 11:13:30,091 [INFO] [backend.services.mfa] Generating MFA secret for email: testuser@example.com
2025-01-28 11:13:30,120 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-28 11:13:30,122 [INFO] [backend.services.mfa] Verifying MFA code
2025-01-28 11:13:30,127 [INFO] [backend.services.mfa] Resetting MFA for user_id: 4220b362-8211-4993-9641-2f3ef7f772a8
2025-01-28 11:13:30,132 [INFO] [backend.services.mfa] MFA reset successfully for user_id: 4220b362-8211-4993-9641-2f3ef7f772a8
2025-01-28 11:13:30,137 [INFO] [backend.services.mfa] Resetting MFA for user_id: 60333cb1-e228-4d6e-8714-8919fa641244
2025-01-28 11:13:30,138 [ERROR] [backend.services.mfa] User not found for MFA reset: 60333cb1-e228-4d6e-8714-8919fa641244
2025-01-28 11:13:31,114 [INFO] [backend.api.payments.payment_service] Creating Stripe payment for user 7050f097-d11b-41a9-b3f2-74efce1917da, subscription tier ID: b69a0bca-77df-4bfe-bd15-8918d5cfabd3
2025-01-28 11:13:31,117 [ERROR] [backend.api.payments.payment_service] Error creating Stripe session: 'dict' object has no attribute 'id'
2025-01-28 11:13:31,160 [INFO] [backend.api.payments.payment_service] Processing refund for payment ID: 000767a0-08b1-4d28-a075-57627975d119
2025-01-28 11:13:31,165 [INFO] [backend.api.payments.payment_service] Payment refunded successfully: 000767a0-08b1-4d28-a075-57627975d119
2025-01-28 11:13:31,174 [INFO] [backend.api.payments.payment_service] Fetching payment history for user ID: e3bfa69f-2c1d-4f07-a6a1-e1b9c5c9e449
2025-01-28 11:13:31,493 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,494 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-28 11:13:31,494 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-28 11:13:31,494 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,496 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,504 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,505 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/notifications
2025-01-28 11:13:31,505 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/notifications
2025-01-28 11:13:31,505 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,507 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/notifications "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,515 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,517 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/reset-mfa
2025-01-28 11:13:31,517 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/reset-mfa
2025-01-28 11:13:31,517 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,518 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/reset-mfa "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,525 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,526 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-28 11:13:31,526 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-28 11:13:31,526 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,528 [INFO] [httpx] HTTP Request: GET http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,536 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,538 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/settings/subscription
2025-01-28 11:13:31,538 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/settings/subscription
2025-01-28 11:13:31,538 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,539 [INFO] [httpx] HTTP Request: PUT http://testserver/api/settings/subscription "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,628 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,630 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/7f192f57-0b2b-425a-b5f3-b3a37f15ac45
2025-01-28 11:13:31,630 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/7f192f57-0b2b-425a-b5f3-b3a37f15ac45
2025-01-28 11:13:31,630 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/7f192f57-0b2b-425a-b5f3-b3a37f15ac45
2025-01-28 11:13:31,630 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/7f192f57-0b2b-425a-b5f3-b3a37f15ac45
2025-01-28 11:13:31,631 [INFO] [backend.main] Processing request GET http://testserver/api/subscriptions/7f192f57-0b2b-425a-b5f3-b3a37f15ac45
2025-01-28 11:13:31,632 [INFO] [backend.api.subscriptions.subscription_routes] Retrieving subscription tier with ID: 7f192f57-0b2b-425a-b5f3-b3a37f15ac45
2025-01-28 11:13:31,637 [ERROR] [backend.api.subscriptions.subscription_routes] Error retrieving subscription tier 7f192f57-0b2b-425a-b5f3-b3a37f15ac45: 404: Subscription tier not found.
2025-01-28 11:13:31,637 [INFO] [backend.main] Response status: 500
2025-01-28 11:13:31,638 [INFO] [httpx] HTTP Request: GET http://testserver/api/subscriptions/7f192f57-0b2b-425a-b5f3-b3a37f15ac45 "HTTP/1.1 500 Internal Server Error"
2025-01-28 11:13:31,646 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,647 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/
2025-01-28 11:13:31,647 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/
2025-01-28 11:13:31,647 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/
2025-01-28 11:13:31,647 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/
2025-01-28 11:13:31,648 [INFO] [backend.main] Processing request POST http://testserver/api/subscriptions/
2025-01-28 11:13:31,655 [INFO] [backend.main] Response status: 422
2025-01-28 11:13:31,656 [INFO] [httpx] HTTP Request: POST http://testserver/api/subscriptions/ "HTTP/1.1 422 Unprocessable Entity"
2025-01-28 11:13:31,666 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,668 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/4b587344-871c-49a3-9bbc-d11def096200
2025-01-28 11:13:31,668 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/4b587344-871c-49a3-9bbc-d11def096200
2025-01-28 11:13:31,668 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/4b587344-871c-49a3-9bbc-d11def096200
2025-01-28 11:13:31,668 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/4b587344-871c-49a3-9bbc-d11def096200
2025-01-28 11:13:31,669 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/4b587344-871c-49a3-9bbc-d11def096200
2025-01-28 11:13:31,671 [INFO] [backend.main] Response status: 422
2025-01-28 11:13:31,672 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/4b587344-871c-49a3-9bbc-d11def096200 "HTTP/1.1 422 Unprocessable Entity"
2025-01-28 11:13:31,681 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,682 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/dab16c80-d219-41c9-b213-4e8afaffde14
2025-01-28 11:13:31,683 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/dab16c80-d219-41c9-b213-4e8afaffde14
2025-01-28 11:13:31,683 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/dab16c80-d219-41c9-b213-4e8afaffde14
2025-01-28 11:13:31,683 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/dab16c80-d219-41c9-b213-4e8afaffde14
2025-01-28 11:13:31,683 [INFO] [backend.main] Processing request DELETE http://testserver/api/subscriptions/dab16c80-d219-41c9-b213-4e8afaffde14
2025-01-28 11:13:31,685 [INFO] [backend.main] Response status: 422
2025-01-28 11:13:31,686 [INFO] [httpx] HTTP Request: DELETE http://testserver/api/subscriptions/dab16c80-d219-41c9-b213-4e8afaffde14 "HTTP/1.1 422 Unprocessable Entity"
2025-01-28 11:13:31,695 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,696 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /api/subscriptions/0640913f-557f-43cb-8bc0-26a57f656978/deactivate
2025-01-28 11:13:31,696 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /api/subscriptions/0640913f-557f-43cb-8bc0-26a57f656978/deactivate
2025-01-28 11:13:31,696 [DEBUG] [backend.api.middlewares.mfa_middleware] Skipping MFA check for route: /api/subscriptions/0640913f-557f-43cb-8bc0-26a57f656978/deactivate
2025-01-28 11:13:31,697 [DEBUG] [backend.api.middlewares.session_middleware] Processing request to: /api/subscriptions/0640913f-557f-43cb-8bc0-26a57f656978/deactivate
2025-01-28 11:13:31,697 [INFO] [backend.main] Processing request PUT http://testserver/api/subscriptions/0640913f-557f-43cb-8bc0-26a57f656978/deactivate
2025-01-28 11:13:31,698 [INFO] [backend.main] Response status: 422
2025-01-28 11:13:31,699 [INFO] [httpx] HTTP Request: PUT http://testserver/api/subscriptions/0640913f-557f-43cb-8bc0-26a57f656978/deactivate "HTTP/1.1 422 Unprocessable Entity"
2025-01-28 11:13:31,711 [INFO] [backend.api.subscriptions.subscription_service] Fetching subscription details for user ID 47fc6829-96bb-4857-b024-34ac6f3d9c7e
2025-01-28 11:13:31,714 [WARNING] [backend.api.subscriptions.subscription_service] Subscription tier not found for user ID 47fc6829-96bb-4857-b024-34ac6f3d9c7e
2025-01-28 11:13:31,731 [INFO] [backend.api.subscriptions.subscription_service] Updating subscription for user ID f22b2484-2fd2-46fa-9cd1-20b1ba132ae3
2025-01-28 11:13:31,749 [INFO] [backend.api.subscriptions.subscription_service] Cancelling subscription for user ID 7fb24331-dccd-4bc6-b64a-0f221f46979d
2025-01-28 11:13:31,766 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,768 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:13:31,768 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:13:31,768 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,769 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,778 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,780 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 11:13:31,780 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 11:13:31,780 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,781 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,791 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,792 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:13:31,792 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:13:31,792 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,793 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,801 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,802 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 11:13:31,803 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 11:13:31,803 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,805 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,815 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,817 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 11:13:31,817 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 11:13:31,817 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,818 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=f092b305-2d71-46c8-8bb6-c2e725883475 "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:31,828 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:13:31,829 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 11:13:31,829 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 11:13:31,830 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:13:31,831 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 11:13:32,034 [INFO] [backend.api.auth.auth_service] User created: ID=2bdbfe66-b11e-43b3-ac93-aa4c050dd921, username=testuser
2025-01-28 11:13:32,231 [INFO] [backend.api.auth.auth_service] User created: ID=e939ad54-25a6-41ea-966c-ea85eac74774, username=testuser
2025-01-28 11:13:32,430 [INFO] [backend.api.auth.auth_service] User created: ID=255265b8-ecfd-4fc6-91eb-2ae52139997e, username=testuser
2025-01-28 11:13:32,814 [INFO] [backend.api.auth.auth_service] User created: ID=327684b0-0d49-4592-aa23-dfc966c7c102, username=testuser
2025-01-28 11:13:33,004 [WARNING] [backend.api.auth.auth_service] Unverified email login attempt: testuser
2025-01-28 11:13:33,199 [INFO] [backend.api.auth.auth_service] User created: ID=343a6568-3f47-4d4c-9c53-4b97e87e2f1e, username=testuser
2025-01-28 11:13:33,200 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: invaliduser
2025-01-28 11:13:33,393 [INFO] [backend.api.auth.auth_service] User created: ID=25fa02a1-5571-4ed7-a3e5-f99d4aa66df8, username=testuser
2025-01-28 11:13:33,582 [WARNING] [backend.api.auth.auth_service] Authentication failed for username: testuser
2025-01-28 11:20:18,563 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 11:20:18,976 [INFO] [backend.main] Session validation middleware added.
2025-01-28 11:20:18,976 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 11:20:18,976 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 11:20:18,976 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 11:20:18,976 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 11:20:18,979 [INFO] [backend.main] Auth router registered.
2025-01-28 11:20:18,984 [INFO] [backend.main] User router registered.
2025-01-28 11:20:18,987 [INFO] [backend.main] Workout router registered.
2025-01-28 11:20:18,995 [INFO] [backend.main] Payment router registered.
2025-01-28 11:20:19,000 [INFO] [backend.main] Subscription router registered.
2025-01-28 11:20:19,000 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 11:20:19,003 [INFO] [backend.main] Admin router registered.
2025-01-28 11:20:19,133 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:19,134 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:20:19,135 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:20:19,135 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:19,135 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:19,426 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:19,428 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 11:20:19,428 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 11:20:19,428 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:19,428 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:19,435 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:19,436 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:20:19,436 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:20:19,436 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:19,437 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:19,446 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:19,447 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 11:20:19,447 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 11:20:19,447 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:19,448 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:19,462 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:19,463 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 11:20:19,463 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 11:20:19,464 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:19,464 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=e0c696cf-b376-4da1-8b4f-cace098fc66a "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:19,472 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:19,474 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 11:20:19,474 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 11:20:19,474 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:19,475 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:36,983 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 11:20:37,387 [INFO] [backend.main] Session validation middleware added.
2025-01-28 11:20:37,387 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 11:20:37,388 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 11:20:37,388 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 11:20:37,388 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 11:20:37,392 [INFO] [backend.main] Auth router registered.
2025-01-28 11:20:37,397 [INFO] [backend.main] User router registered.
2025-01-28 11:20:37,401 [INFO] [backend.main] Workout router registered.
2025-01-28 11:20:37,407 [INFO] [backend.main] Payment router registered.
2025-01-28 11:20:37,412 [INFO] [backend.main] Subscription router registered.
2025-01-28 11:20:37,413 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 11:20:37,415 [INFO] [backend.main] Admin router registered.
2025-01-28 11:20:37,545 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:37,547 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:20:37,547 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:20:37,548 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:37,549 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:37,853 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:37,855 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 11:20:37,855 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 11:20:37,855 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:37,856 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:37,863 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:37,864 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:20:37,865 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:20:37,865 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:37,866 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:37,874 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:37,875 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 11:20:37,875 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 11:20:37,876 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:37,876 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:37,891 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:37,892 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 11:20:37,893 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 11:20:37,893 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:37,894 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=30062778-ee46-497c-b9c9-0a9e7a5459dc "HTTP/1.1 401 Unauthorized"
2025-01-28 11:20:37,901 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:20:37,903 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 11:20:37,903 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 11:20:37,903 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:20:37,904 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 11:38:57,800 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 11:38:58,215 [INFO] [backend.main] Session validation middleware added.
2025-01-28 11:38:58,215 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 11:38:58,215 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 11:38:58,215 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 11:38:58,215 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 11:38:58,219 [INFO] [backend.main] Auth router registered.
2025-01-28 11:38:58,223 [INFO] [backend.main] User router registered.
2025-01-28 11:38:58,227 [INFO] [backend.main] Workout router registered.
2025-01-28 11:38:58,233 [INFO] [backend.main] Payment router registered.
2025-01-28 11:38:58,240 [INFO] [backend.main] Subscription router registered.
2025-01-28 11:38:58,240 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 11:38:58,242 [INFO] [backend.main] Admin router registered.
2025-01-28 11:38:58,373 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:38:58,375 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:38:58,375 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:38:58,375 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:38:58,377 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:38:58,696 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:38:58,698 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 11:38:58,698 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 11:38:58,698 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:38:58,700 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 11:38:58,708 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:38:58,709 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:38:58,709 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:38:58,709 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:38:58,710 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:38:58,718 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:38:58,719 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 11:38:58,719 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 11:38:58,719 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:38:58,720 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 11:38:58,736 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:38:58,737 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 11:38:58,737 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 11:38:58,739 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:38:58,740 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=57b63ae7-1686-448f-8dd9-0b3fad6957ea "HTTP/1.1 401 Unauthorized"
2025-01-28 11:38:58,747 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:38:58,748 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 11:38:58,748 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 11:38:58,748 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:38:58,750 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 11:39:25,202 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 11:39:25,609 [INFO] [backend.main] Session validation middleware added.
2025-01-28 11:39:25,609 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 11:39:25,609 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 11:39:25,609 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 11:39:25,609 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 11:39:25,614 [INFO] [backend.main] Auth router registered.
2025-01-28 11:39:25,619 [INFO] [backend.main] User router registered.
2025-01-28 11:39:25,622 [INFO] [backend.main] Workout router registered.
2025-01-28 11:39:25,629 [INFO] [backend.main] Payment router registered.
2025-01-28 11:39:25,635 [INFO] [backend.main] Subscription router registered.
2025-01-28 11:39:25,635 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 11:39:25,637 [INFO] [backend.main] Admin router registered.
2025-01-28 11:39:25,769 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:39:25,771 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:39:25,771 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:39:25,771 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:39:25,772 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:39:26,065 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:39:26,066 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 11:39:26,066 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 11:39:26,066 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:39:26,068 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 11:39:26,075 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:39:26,076 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 11:39:26,078 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 11:39:26,078 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:39:26,079 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 11:39:26,101 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:39:26,103 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 11:39:26,103 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 11:39:26,103 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:39:26,104 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 11:39:26,119 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:39:26,122 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 11:39:26,122 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 11:39:26,122 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:39:26,123 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=b1689c02-2644-4812-b062-118d06019765 "HTTP/1.1 401 Unauthorized"
2025-01-28 11:39:26,131 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 11:39:26,133 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 11:39:26,133 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 11:39:26,133 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 11:39:26,134 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 12:57:59,068 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 12:57:59,497 [INFO] [backend.main] Session validation middleware added.
2025-01-28 12:57:59,497 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 12:57:59,497 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 12:57:59,498 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 12:57:59,498 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 12:57:59,502 [INFO] [backend.main] Auth router registered.
2025-01-28 12:57:59,507 [INFO] [backend.main] User router registered.
2025-01-28 12:57:59,510 [INFO] [backend.main] Workout router registered.
2025-01-28 12:57:59,516 [INFO] [backend.main] Payment router registered.
2025-01-28 12:57:59,523 [INFO] [backend.main] Subscription router registered.
2025-01-28 12:57:59,523 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 12:57:59,526 [INFO] [backend.main] Admin router registered.
2025-01-28 12:57:59,661 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 12:57:59,663 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 12:57:59,663 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 12:57:59,663 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 12:57:59,665 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 12:57:59,956 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 12:57:59,957 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 12:57:59,957 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 12:57:59,957 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 12:57:59,958 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 12:57:59,965 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 12:57:59,966 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 12:57:59,966 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 12:57:59,966 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 12:57:59,967 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 12:57:59,974 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 12:57:59,975 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 12:57:59,975 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 12:57:59,975 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 12:57:59,976 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 12:57:59,990 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 12:57:59,991 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 12:57:59,992 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 12:57:59,992 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 12:57:59,993 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=6ec9f4ba-7689-4a4a-b957-283de4faea5e "HTTP/1.1 401 Unauthorized"
2025-01-28 12:58:00,000 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 12:58:00,001 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 12:58:00,001 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 12:58:00,001 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 12:58:00,002 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 13:00:07,673 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 13:00:08,088 [INFO] [backend.main] Session validation middleware added.
2025-01-28 13:00:08,088 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 13:00:08,088 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 13:00:08,088 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 13:00:08,090 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 13:00:08,095 [INFO] [backend.main] Auth router registered.
2025-01-28 13:00:08,101 [INFO] [backend.main] User router registered.
2025-01-28 13:00:08,105 [INFO] [backend.main] Workout router registered.
2025-01-28 13:00:08,114 [INFO] [backend.main] Payment router registered.
2025-01-28 13:00:08,121 [INFO] [backend.main] Subscription router registered.
2025-01-28 13:00:08,121 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 13:00:08,125 [INFO] [backend.main] Admin router registered.
2025-01-28 13:00:08,257 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:00:08,259 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:00:08,259 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:00:08,260 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:00:08,261 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:00:08,561 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:00:08,563 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 13:00:08,563 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 13:00:08,564 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:00:08,565 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 13:00:08,573 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:00:08,574 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:00:08,574 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:00:08,574 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:00:08,576 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:00:08,582 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:00:08,584 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 13:00:08,584 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 13:00:08,584 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:00:08,586 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 13:00:08,603 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:00:08,604 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 13:00:08,604 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 13:00:08,604 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:00:08,606 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=d2a399f6-b403-4b1a-9e0b-c7229285c724 "HTTP/1.1 401 Unauthorized"
2025-01-28 13:00:08,613 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:00:08,613 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 13:00:08,613 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 13:00:08,614 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:00:08,614 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:18,146 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 13:02:18,565 [INFO] [backend.main] Session validation middleware added.
2025-01-28 13:02:18,566 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 13:02:18,566 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 13:02:18,566 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 13:02:18,566 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 13:02:18,569 [INFO] [backend.main] Auth router registered.
2025-01-28 13:02:18,574 [INFO] [backend.main] User router registered.
2025-01-28 13:02:18,578 [INFO] [backend.main] Workout router registered.
2025-01-28 13:02:18,585 [INFO] [backend.main] Payment router registered.
2025-01-28 13:02:18,591 [INFO] [backend.main] Subscription router registered.
2025-01-28 13:02:18,591 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 13:02:18,593 [INFO] [backend.main] Admin router registered.
2025-01-28 13:02:18,730 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:18,732 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:02:18,732 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:02:18,732 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:18,733 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:19,062 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:19,064 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 13:02:19,065 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 13:02:19,065 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:19,066 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:19,074 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:19,075 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:02:19,076 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:02:19,076 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:19,076 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:19,085 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:19,088 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 13:02:19,088 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 13:02:19,088 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:19,089 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:19,106 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:19,107 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 13:02:19,107 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 13:02:19,107 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:19,108 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=dd93b3a0-a9ea-42df-ba87-e03ecffa2ac9 "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:19,117 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:19,118 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 13:02:19,118 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 13:02:19,118 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:19,120 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:50,752 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-28 13:02:50,752 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-28 13:02:50,752 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-28 13:02:50,774 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 13:02:51,131 [INFO] [backend.main] Session validation middleware added.
2025-01-28 13:02:51,131 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 13:02:51,131 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 13:02:51,132 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 13:02:51,132 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 13:02:51,136 [INFO] [backend.main] Auth router registered.
2025-01-28 13:02:51,140 [INFO] [backend.main] User router registered.
2025-01-28 13:02:51,143 [INFO] [backend.main] Workout router registered.
2025-01-28 13:02:51,150 [INFO] [backend.main] Payment router registered.
2025-01-28 13:02:51,156 [INFO] [backend.main] Subscription router registered.
2025-01-28 13:02:51,156 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 13:02:51,159 [INFO] [backend.main] Admin router registered.
2025-01-28 13:02:51,184 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:51,186 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:02:51,187 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:02:51,187 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:51,188 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:51,503 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:51,504 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 13:02:51,506 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 13:02:51,506 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:51,507 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:51,512 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:51,514 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:02:51,514 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:02:51,514 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:51,515 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:51,522 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:51,523 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 13:02:51,523 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 13:02:51,524 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:51,524 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:51,530 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:51,532 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 13:02:51,532 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 13:02:51,532 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:51,533 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=8d0d9ce7-c92c-4c67-8bf3-e94055d13682 "HTTP/1.1 401 Unauthorized"
2025-01-28 13:02:51,538 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:02:51,539 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 13:02:51,539 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 13:02:51,539 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:02:51,541 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 13:03:06,118 [DEBUG] [passlib.utils.compat] loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-01-28 13:03:06,119 [DEBUG] [passlib.utils.compat] loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-01-28 13:03:06,119 [DEBUG] [passlib.utils.compat] loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-01-28 13:03:06,142 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 13:03:06,530 [INFO] [backend.main] Session validation middleware added.
2025-01-28 13:03:06,530 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 13:03:06,530 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 13:03:06,530 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 13:03:06,530 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 13:03:06,537 [INFO] [backend.main] Auth router registered.
2025-01-28 13:03:06,542 [INFO] [backend.main] User router registered.
2025-01-28 13:03:06,546 [INFO] [backend.main] Workout router registered.
2025-01-28 13:03:06,553 [INFO] [backend.main] Payment router registered.
2025-01-28 13:03:06,559 [INFO] [backend.main] Subscription router registered.
2025-01-28 13:03:06,560 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 13:03:06,562 [INFO] [backend.main] Admin router registered.
2025-01-28 13:03:06,593 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:03:06,595 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:03:06,596 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:03:06,596 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:03:06,598 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:03:06,901 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:03:06,903 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile/version
2025-01-28 13:03:06,903 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile/version
2025-01-28 13:03:06,903 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:03:06,904 [INFO] [httpx] HTTP Request: GET http://testserver/profile/version "HTTP/1.1 401 Unauthorized"
2025-01-28 13:03:06,909 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:03:06,910 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:03:06,910 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:03:06,910 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:03:06,911 [INFO] [httpx] HTTP Request: PUT http://testserver/profile "HTTP/1.1 401 Unauthorized"
2025-01-28 13:03:06,916 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:03:06,917 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /deactivate
2025-01-28 13:03:06,919 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /deactivate
2025-01-28 13:03:06,919 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:03:06,919 [INFO] [httpx] HTTP Request: PUT http://testserver/deactivate "HTTP/1.1 401 Unauthorized"
2025-01-28 13:03:06,926 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:03:06,928 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /reactivate
2025-01-28 13:03:06,928 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /reactivate
2025-01-28 13:03:06,928 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:03:06,928 [INFO] [httpx] HTTP Request: PUT http://testserver/reactivate?user_id=b00d06e9-eaf8-40dc-a304-b4fc4d67d623 "HTTP/1.1 401 Unauthorized"
2025-01-28 13:03:06,934 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:03:06,935 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /active-status
2025-01-28 13:03:06,935 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /active-status
2025-01-28 13:03:06,935 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:03:06,936 [INFO] [httpx] HTTP Request: GET http://testserver/active-status "HTTP/1.1 401 Unauthorized"
2025-01-28 13:04:45,882 [DEBUG] [passlib.registry] registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-01-28 13:04:46,304 [INFO] [backend.main] Session validation middleware added.
2025-01-28 13:04:46,304 [INFO] [backend.main] MFA validation middleware added.
2025-01-28 13:04:46,304 [INFO] [backend.main] Admin validation middleware added.
2025-01-28 13:04:46,304 [INFO] [backend.main] CORS middleware configured with origins: ['http://localhost:3000']
2025-01-28 13:04:46,304 [ERROR] [backend.main] Failed to mount static files: Directory '../frontend/build' does not exist
2025-01-28 13:04:46,308 [INFO] [backend.main] Auth router registered.
2025-01-28 13:04:46,313 [INFO] [backend.main] User router registered.
2025-01-28 13:04:46,317 [INFO] [backend.main] Workout router registered.
2025-01-28 13:04:46,325 [INFO] [backend.main] Payment router registered.
2025-01-28 13:04:46,331 [INFO] [backend.main] Subscription router registered.
2025-01-28 13:04:46,331 [INFO] [backend.main] Stripe Webhook router registered.
2025-01-28 13:04:46,333 [INFO] [backend.main] Admin router registered.
2025-01-28 13:04:46,362 [DEBUG] [asyncio] Using proactor: IocpProactor
2025-01-28 13:04:46,364 [DEBUG] [backend.api.middlewares.admin_middleware] Processing request to: /profile
2025-01-28 13:04:46,364 [DEBUG] [backend.api.middlewares.mfa_middleware] Processing request to: /profile
2025-01-28 13:04:46,364 [WARNING] [backend.api.middlewares.mfa_middleware] Missing or malformed Authorization header
2025-01-28 13:04:46,366 [INFO] [httpx] HTTP Request: GET http://testserver/profile "HTTP/1.1 401 Unauthorized"
